// import React, { useState, useEffect } from 'react';
// import { motion, AnimatePresence } from 'framer-motion';
// import { Loader2 } from 'lucide-react';
// import { fetchHeroVariants } from '../../api/homepage';
// import { useHomepageData, getStorageUrl } from '../../hooks/useHomepageData';
// import { Icon } from '../common/IconMap';

// // --- HeroVariant1 ---
// const HeroVariant1 = ({ variant }) => {
//   const textVariants = {
//     enter: { opacity: 1, y: 0, transition: { type: 'spring', stiffness: 100, damping: 10 } },
//     exit: { opacity: 0, y: 20 },
//   };
//   const iconVariants = {
//     enter: { opacity: 1, scale: 1, transition: { type: 'spring', stiffness: 150 } },
//     exit: { opacity: 0, scale: 0.5 },
//   };
//   // ... (add lineVariants if you have SVG lines) ...

//   return (
//     <motion.div
//       className="absolute inset-0 flex flex-col items-center justify-center text-center p-4"
//       variants={{
//         enter: { transition: { staggerChildren: 0.1 } },
//         exit: { transition: { staggerChildren: 0.1, staggerDirection: -1 } },
//       }}
//       initial="exit"
//       animate="enter"
//       exit="exit"
//     >
//       {/* Map over variant.hero_variant1_icons */}
//       {variant.hero_variant1_icons.map((icon, i) => (
//         <motion.div
//           key={icon.id || i}
//           className="absolute text-blue-300"
//           style={{
//             top: icon.position?.top,
//             left: icon.position?.left,
//             right: icon.position?.right,
//             bottom: icon.position?.bottom,
//           }}
//           variants={iconVariants}
//         >
//           <Icon name={icon.icon_name} size={icon.position?.size || 20} />
//         </motion.div>
//       ))}
      
//       <motion.h2
//         className="text-sm font-bold text-blue-600 uppercase"
//         variants={textVariants}
//       >
//         {variant.subtitle}
//       </motion.h2>
//       <motion.h1
//         className="text-4xl md:text-6xl font-extrabold text-gray-900 my-4"
//         variants={textVariants}
//       >
//         {variant.title}
//       </motion.h1>
//       <motion.p
//         className="text-lg text-gray-600 max-w-lg"
//         variants={textVariants}
//       >
//         {variant.paragraph}
//       </motion.p>
//     </motion.div>
//   );
// };

// // --- HeroVariant2 ---
// const HeroVariant2 = ({ variant }) => {
//   const textVariants = {
//     enter: { opacity: 1, y: 0, transition: { type: 'spring', stiffness: 100, damping: 10 } },
//     exit: { opacity: 0, y: 20 },
//   };
//   const gridVariants = {
//     enter: { transition: { staggerChildren: 0.1 } },
//     exit: { transition: { staggerChildren: 0.1, staggerDirection: -1 } },
//   };
//   const photoVariants = (delay = 0, rotation = 0) => ({
//     enter: { opacity: 1, scale: 1, rotate: rotation, transition: { type: 'spring', stiffness: 100, delay } },
//     exit: { opacity: 0, scale: 0.8, rotate: rotation },
//   });

//   return (
//     <motion.div
//       className="absolute inset-0 grid grid-cols-1 md:grid-cols-2 gap-8 items-center p-8"
//       variants={gridVariants}
//       initial="exit"
//       animate="enter"
//       exit="exit"
//     >
//       {/* Left Column: Text */}
//       <div className="max-w-md">
//         <motion.h2
//           className="text-sm font-bold text-blue-600 uppercase"
//           variants={textVariants}
//         >
//           {variant.subtitle}
//         </motion.h2>
//         <motion.h1
//           className="text-4xl md:text-5xl font-extrabold text-gray-900 my-4"
//           variants={textVariants}
//         >
//           {variant.title}
//         </motion.h1>
//         <motion.p className="text-lg text-gray-600" variants={textVariants}>
//           {variant.paragraph}
//         </motion.p>
//       </div>
      
//       {/* Right Column: Photos */}
//       <motion.div
//         className="grid grid-cols-3 gap-4"
//         variants={gridVariants}
//       >
//         {variant.hero_variant2_photos.map((photo) => {
//           const imageUrl = getStorageUrl(photo.media_assets);
//           if (!imageUrl) return null;

//           return (
//             <motion.div
//               key={photo.id}
//               variants={photoVariants(photo.delay, photo.rotation)}
//               animate={{ y: [0, -10, 0] }} // Infinite float
//               transition={{
//                 duration: 2,
//                 repeat: Infinity,
//                 delay: photo.delay,
//                 ease: 'easeInOut',
//               }}
//             >
//               <img
//                 src={imageUrl}
//                 alt={photo.media_assets?.alt_text || 'Hero Image'}
//                 className="rounded-lg shadow-lg object-cover w-full h-auto aspect-[3/4]"
//               />
//             </motion.div>
//           );
//         })}
//       </motion.div>
//     </motion.div>
//   );
// };

// // --- Main Hero Component ---
// const Hero = () => {
//   const { data: variants, loading } = useHomepageData(
//     fetchHeroVariants, 
//     'hero_variants', 
//     { additionalTables: ['hero_variant1_icons', 'hero_variant2_photos', 'media_assets'] }
//   );
//   const [heroIndex, setHeroIndex] = useState(0);

//   useEffect(() => {
//     if (variants && variants.length > 1) {
//       const timer = setTimeout(() => {
//         setHeroIndex((prev) => (prev + 1) % variants.length);
//       }, 5000); // 5 seconds
//       return () => clearTimeout(timer);
//     }
//   }, [heroIndex, variants]);

//   if (loading) {
//     return (
//       <section className="h-screen bg-gray-100 flex items-center justify-center">
//         <Loader2 className="w-12 h-12 animate-spin text-blue-600" />
//       </section>
//     );
//   }

//   if (!variants || variants.length === 0) {
//     return <section className="h-screen bg-gray-100" />; // No variants found
//   }

//   const activeVariant = variants[heroIndex];
//   if (!activeVariant) return null;

//   const Component = activeVariant.variant_type === 'variant1' ? HeroVariant1 : HeroVariant2;

//   return (
//     <section className="relative h-screen overflow-hidden bg-gray-50">
//       <AnimatePresence mode="wait">
//         <Component key={activeVariant.id} variant={activeVariant} />
//       </AnimatePresence>
//     </section>
//   );
// };

// export default Hero;


// // // // // import React from 'react';
// // // // // import { Link } from 'react-router-dom';
// // // // // import { ArrowLeft, Save, Loader2 } from 'lucide-react';
// // // // // import { motion } from 'framer-motion';

// // // // // // This is a placeholder editor. You would build a form here.
// // // // // const AdminHeroEditor = () => {
// // // // //   const isSaving = false; // Placeholder for save state

// // // // //   return (
// // // // //     <motion.div
// // // // //       initial={{ opacity: 0, y: 20 }}
// // // // //       animate={{ opacity: 1, y: 0 }}
// // // // //       className="space-y-6"
// // // // //     >
// // // // //       {/* Header */}
// // // // //       <div className="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
// // // // //         <div>
// // // // //           <Link
// // // // //             to="/admin/homepage-config"
// // // // //             className="flex items-center gap-2 text-sm text-gray-500 hover:text-gray-900 mb-2"
// // // // //           >
// // // // //             <ArrowLeft className="w-4 h-4" />
// // // // //             Back to Homepage Manager
// // // // //           </Link>
// // // // //           <h1 className="text-3xl font-bold text-gray-900">Edit Hero Section</h1>
// // // // //         </div>
// // // // //         <button
// // // // //           disabled={isSaving}
// // // // //           className="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-blue-700 transition disabled:opacity-50"
// // // // //         >
// // // // //           {isSaving ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
// // // // //           {isSaving ? 'Saving...' : 'Save Changes'}
// // // // //         </button>
// // // // //       </div>

// // // // //       {/* Editor Content Area */}
// // // // //       <div className="bg-white p-8 rounded-lg shadow border border-gray-200">
// // // // //         <h2 className="text-xl font-semibold text-gray-800">Hero Editor</h2>
// // // // //         <p className="text-gray-500 mt-2">
// // // // //           This is where you will add forms to edit your hero variants, including titles,
// // // // //           subtitles, and image uploads.
// // // // //         </p>
// // // // //         {/* TODO: Add forms here to edit the 'hero_variants' table */}
// // // // //       </div>
// // // // //     </motion.div>
// // // // //   );
// // // // // };

// // // // // export default AdminHeroEditor;
// // // // import React, { useState, useEffect, useCallback } from 'react';
// // // // import { Link } from 'react-router-dom';
// // // // import {
// // // //   ArrowLeft, Save, Loader2, Plus, Trash2, Eye, EyeOff, GripVertical, Image as ImageIcon, Wind, AlertTriangle, UploadCloud
// // // // } from 'lucide-react';
// // // // import { motion, AnimatePresence, Reorder } from 'framer-motion';
// // // // import { useForm, useFieldArray, Controller } from 'react-hook-form';
// // // // // import {
// // // // //   getHeroVariantsAdmin,
// // // // //   subscribeToHeroChanges,
// // // // //   updateHeroVariantsOrder,
// // // // //   deleteHeroVariant,
// // // // //   saveHeroVariant,
// // // // // } from '../../api/admin_hero';
// // // // // import { getStorageUrl } from '../../hooks/useHomepageData';
// // // // import { getStorageUrl } from '../../../hooks/useHomepageData';
// // // // // import { Icon } from '../../components/common/IconMap';
// // // // import Icon from '../../../components/common/IconMap';
// // // // import toast, { Toaster } from 'react-hot-toast';
// // // // import {
// // // //   getHeroVariantsAdmin,
// // // //   subscribeToHeroChanges,
// // // //     updateHeroVariantsOrder,
// // // //   deleteHeroVariant,
// // // //   saveHeroVariant,

// // // // } from '../../../api/heroadmin';

// // // // // --- Reusable Form Components ---
// // // // const FormInput = ({ label, name, register, errors, ...rest }) => (
// // // //   <div className="flex flex-col">
// // // //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// // // //     <input id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'}`} />
// // // //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// // // //   </div>
// // // // );

// // // // const FormTextarea = ({ label, name, register, errors, ...rest }) => (
// // // //   <div className="flex flex-col">
// // // //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// // // //     <textarea id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'}`} rows="3" />
// // // //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// // // //   </div>
// // // // );

// // // // const FormToggle = ({ label, name, control }) => (
// // // //   <Controller
// // // //     name={name}
// // // //     control={control}
// // // //     render={({ field: { value, onChange } }) => (
// // // //       <label className="flex items-center justify-between cursor-pointer">
// // // //         <span className="text-sm font-medium text-gray-700">{label}</span>
// // // //         <button
// // // //           type="button"
// // // //           onClick={() => onChange(!value)}
// // // //           className={`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out ${value ? 'bg-blue-600' : 'bg-gray-200'}`}
// // // //         >
// // // //           <span className={`inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${value ? 'translate-x-5' : 'translate-x-0'}`} />
// // // //         </button>
// // // //       </label>
// // // //     )}
// // // //   />
// // // // );

// // // // // --- Advanced Image Uploader Component ---
// // // // const ImageUpload = ({ control, name, defaultValue }) => {
// // // //   const [preview, setPreview] = useState(getStorageUrl(defaultValue));
// // // //   const [isUploading, setIsUploading] = useState(false);
  
// // // //   const handleFileChange = (e, onChange) => {
// // // //     const file = e.target.files[0];
// // // //     if (file) {
// // // //       setPreview(URL.createObjectURL(file));
// // // //       // 'file' will be caught by our API to trigger an upload
// // // //       // 'originalMediaId' is crucial for deleting the old file
// // // //       onChange({ file, originalMediaId: defaultValue?.id });
// // // //     }
// // // //   };

// // // //   return (
// // // //     <Controller
// // // //       name={name}
// // // //       control={control}
// // // //       defaultValue={defaultValue ? { media_id: defaultValue.id } : null} // Store existing media_id
// // // //       render={({ field: { onChange, value } }) => (
// // // //         <div className="flex flex-col items-center gap-2 p-2 border border-dashed rounded-md">
// // // //           {preview ? (
// // // //             <img src={preview} alt="Preview" className="w-24 h-24 object-cover rounded-md" />
// // // //           ) : (
// // // //             <div className="w-24 h-24 bg-gray-100 rounded-md flex items-center justify-center">
// // // //               <ImageIcon className="w-8 h-8 text-gray-400" />
// // // //             </div>
// // // //           )}
// // // //           <input
// // // //             type="file"
// // // //             id={`file-upload-${name}`}
// // // //             className="hidden"
// // // //             accept="image/png, image/jpeg, image/webp"
// // // //             onChange={(e) => handleFileChange(e, onChange)}
// // // //             disabled={isUploading}
// // // //           />
// // // //           <label
// // // //             htmlFor={`file-upload-${name}`}
// // // //             className="cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800 p-2 rounded-md bg-blue-50 hover:bg-blue-100 w-full text-center"
// // // //           >
// // // //             {isUploading ? <Loader2 className="animate-spin" /> : (value?.file ? 'File Selected' : 'Change Image')}
// // // //           </label>
// // // //         </div>
// // // //       )}
// // // //     />
// // // //   );
// // // // };


// // // // // --- Hero Variant Editor Modal ---
// // // // const VariantEditorModal = ({ variant, onClose, onSave, allIcons }) => {
// // // //   const { register, handleSubmit, control, watch, formState: { errors, isSubmitting } } = useForm({
// // // //     defaultValues: variant || {
// // // //       title: '',
// // // //       subtitle: '',
// // // //       paragraph: '',
// // // //       variant_type: 'variant1',
// // // //       is_active: true,
// // // //       hero_variant1_icons: [],
// // // //       hero_variant2_photos: [],
// // // //     },
// // // //   });

// // // //   const selectedVariantType = watch('variant_type');

// // // //   const { fields: iconFields, append: appendIcon, remove: removeIcon } = useFieldArray({
// // // //     control,
// // // //     name: 'hero_variant1_icons',
// // // //   });

// // // //   const { fields: photoFields, append: appendPhoto, remove: removePhoto } = useFieldArray({
// // // //     control,
// // // //     name: 'hero_variant2_photos',
// // // //   });

// // // //   const onSubmit = async (data) => {
// // // //     const toastId = toast.loading(variant?.id ? 'Updating variant...' : 'Creating variant...');
    
// // // //     // We pass the *entire* form data to the API function
// // // //     const { success, error } = await saveHeroVariant(data);
    
// // // //     toast.dismiss(toastId);
// // // //     if (success) {
// // // //       toast.success('Variant saved successfully!');
// // // //       onSave(); // This will trigger a refetch in the parent
// // // //       onClose(); // Close the modal
// // // //     } else {
// // // //       toast.error(`Error: ${error}`);
// // // //     }
// // // //   };

// // // //   return (
// // // //     <motion.div
// // // //       initial={{ opacity: 0 }}
// // // //       animate={{ opacity: 1 }}
// // // //       exit={{ opacity: 0 }}
// // // //       className="fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4"
// // // //       onClick={onClose}
// // // //     >
// // // //       <motion.div
// // // //         initial={{ y: 50, scale: 0.95 }}
// // // //         animate={{ y: 0, scale: 1 }}
// // // //         exit={{ y: 50, scale: 0.95 }}
// // // //         className="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"
// // // //         onClick={e => e.stopPropagation()}
// // // //       >
// // // //         <div className="flex justify-between items-center p-6 border-b">
// // // //           <h2 className="text-2xl font-bold text-gray-900">
// // // //             {variant?.id ? 'Edit Hero Variant' : 'Create New Hero Variant'}
// // // //           </h2>
// // // //           <button onClick={onClose} className="text-gray-400 hover:text-gray-700">&times;</button>
// // // //         </div>

// // // //         <form onSubmit={handleSubmit(onSubmit)} className="flex-1 overflow-y-auto p-6 space-y-6">
// // // //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
// // // //             <FormInput label="Title" name="title" register={register} errors={errors} />
// // // //             <FormInput label="Subtitle" name="subtitle" register={register} errors={errors} />
// // // //           </div>
// // // //           <FormTextarea label="Paragraph" name="paragraph" register={register} errors={errors} />
          
// // // //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
// // // //             <Controller
// // // //               name="variant_type"
// // // //               control={control}
// // // //               render={({ field }) => (
// // // //                 <div className="flex flex-col">
// // // //                   <label className="mb-2 text-sm font-medium text-gray-700">Variant Type</label>
// // // //                   <select {...field} className="p-2 border rounded-md bg-white">
// // // //                     <option value="variant1">Variant 1 (Icons)</option>
// // // //                     <option value="variant2">Variant 2 (Photos)</option>
// // // //                   </select>
// // // //                 </div>
// // // //               )}
// // // //             />
// // // //             <FormToggle label="Is Active?" name="is_active" control={control} />
// // // //           </div>

// // // //           {/* --- Conditional Fields --- */}
// // // //           <AnimatePresence mode="wait">
// // // //             {selectedVariantType === 'variant1' ? (
// // // //               <motion.div
// // // //                 key="variant1"
// // // //                 initial={{ opacity: 0, y: 10 }}
// // // //                 animate={{ opacity: 1, y: 0 }}
// // // //                 exit={{ opacity: 0, y: -10 }}
// // // //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// // // //               >
// // // //                 <h3 className="font-semibold text-gray-800">Variant 1: Icons</h3>
// // // //                 {iconFields.map((field, index) => (
// // // //                   <div key={field.id} className="grid grid-cols-3 gap-2 p-2 border-b">
// // // //                     <Controller
// // // //                       name={`hero_variant1_icons.${index}.icon_name`}
// // // //                       control={control}
// // // //                       render={({ field }) => (
// // // //                         <select {...field} className="p-2 border rounded-md bg-white">
// // // //                           <option value="">Select Icon</option>
// // // //                           {allIcons.map(iconName => <option key={iconName} value={iconName}>{iconName}</option>)}
// // // //                         </select>
// // // //                       )}
// // // //                     />
// // // //                     <FormInput
// // // //                       label="Position (JSON)"
// // // //                       name={`hero_variant1_icons.${index}.position`}
// // // //                       register={register}
// // // //                       errors={errors}
// // // //                       placeholder='{"top": "10%", "left": "5%"}'
// // // //                     />
// // // //                     <button type="button" onClick={() => removeIcon(index)} className="text-red-500 hover:text-red-700 self-end">
// // // //                       <Trash2 className="w-5 h-5" />
// // // //                     </button>
// // // //                   </div>
// // // //                 ))}
// // // //                 <button type="button" onClick={() => appendIcon({ icon_name: '', position: '{"top": "0", "left": "0"}' })} className="text-sm text-blue-600">
// // // //                   <Plus className="w-4 h-4 inline mr-1" /> Add Icon
// // // //                 </button>
// // // //               </motion.div>
// // // //             ) : (
// // // //               <motion.div
// // // //                 key="variant2"
// // // //                 initial={{ opacity: 0, y: 10 }}
// // // //                 animate={{ opacity: 1, y: 0 }}
// // // //                 exit={{ opacity: 0, y: -10 }}
// // // //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// // // //               >
// // // //                 <h3 className="font-semibold text-gray-800">Variant 2: Photos</h3>
// // // //                 <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
// // // //                   {photoFields.map((field, index) => (
// // // //                     <div key={field.id} className="space-y-2 p-2 border rounded-md relative">
// // // //                       <ImageUpload
// // // //                         name={`hero_variant2_photos.${index}`}
// // // //                         control={control}
// // // //                         defaultValue={field.media_assets} // Pass the full media_assets object
// // // //                       />
// // // //                       <FormInput
// // // //                         label="Rotation"
// // // //                         name={`hero_variant2_photos.${index}.rotation`}
// // // //                         register={register}
// // // //                         errors={errors}
// // // //                         type="number"
// // // //                       />
// // // //                       <FormInput
// // // //                         label="Delay (s)"
// // // //                         name={`hero_variant2_photos.${index}.delay`}
// // // //                         register={register}
// // // //                         errors={errors}
// // // //                         type="number"
// // // //                         step="0.1"
// // // //                       />
// // // //                       <button
// // // //                         type="button"
// // // //                         onClick={() => removePhoto(index)}
// // // //                         className="absolute -top-2 -right-2 bg-red-500 text-white p-1 rounded-full"
// // // //                       >
// // // //                         <Trash2 className="w-4 h-4" />
// // // //                       </button>
// // // //                     </div>
// // // //                   ))}
// // // //                   <button
// // // //                     type="button"
// // // //                     onClick={() => appendPhoto({ media_id: null, rotation: 0, delay: 0, file: null, originalMediaId: null })}
// // // //                     className="flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-500 hover:border-blue-500 hover:text-blue-500 h-full"
// // // //                   >
// // // //                     <UploadCloud className="w-8 h-8" />
// // // //                     <span className="text-sm mt-2">Add Photo</span>
// // // //                   </button>
// // // //                 </div>
// // // //               </motion.div>
// // // //             )}
// // // //           </AnimatePresence>
// // // //         </form>

// // // //         <div className="flex justify-end items-center p-6 border-t gap-4">
// // // //           <button onClick={onClose} className="text-gray-600 hover:text-gray-900">Cancel</button>
// // // //           <button
// // // //             onClick={handleSubmit(onSubmit)}
// // // //             disabled={isSubmitting}
// // // //             className="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-blue-700 transition disabled:opacity-50"
// // // //           >
// // // //             {isSubmitting ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
// // // //             {isSubmitting ? 'Saving...' : 'Save Changes'}
// // // //           </button>
// // // //         </div>
// // // //       </motion.div>
// // // //     </motion.div>
// // // //   );
// // // // };

// // // // // --- Main Editor Component ---
// // // // const AdminHeroEditor = () => {
// // // //   const [variants, setVariants] = useState([]);
// // // //   const [isLoading, setIsLoading] = useState(true);
// // // //   const [isSavingOrder, setIsSavingOrder] = useState(false);
// // // //   const [isModalOpen, setIsModalOpen] = useState(false);
// // // //   const [selectedVariant, setSelectedVariant] = useState(null);

// // // //   // Get all icon names from our IconMap for the dropdown
// // // //   const allIconNames = Object.keys(Icon);

// // // //   // Fetch and subscribe to data
// // // //   const loadData = useCallback(async () => {
// // // //     setIsLoading(true);
// // // //     const data = await getHeroVariantsAdmin();
// // // //     setVariants(data);
// // // //     setIsLoading(false);
// // // //   }, []);

// // // //   useEffect(() => {
// // // //     loadData();
// // // //     const subscription = subscribeToHeroChanges(loadData);
// // // //     return () => subscription.unsubscribe();
// // // //   }, [loadData]);

// // // //   // --- Handlers ---
// // // //   const handleReorder = async (newOrder) => {
// // // //     setVariants(newOrder); // Update UI immediately
// // // //     setIsSavingOrder(true);
// // // //     await updateHeroVariantsOrder(newOrder);
// // // //     setIsSavingOrder(false);
// // // //     toast.success('Hero order updated!');
// // // //   };
  
// // // //   const handleToggleActive = async (variant) => {
// // // //     const toastId = toast.loading(variant.is_active ? 'Deactivating...' : 'Activating...');
// // // //     await saveHeroVariant({ ...variant, is_active: !variant.is_active });
// // // //     toast.dismiss(toastId);
// // // //     toast.success('Visibility updated!');
// // // //     // Real-time listener will handle the UI update
// // // //   };
  
// // // //   const handleDelete = async (variant) => {
// // // //     if (window.confirm(`Are you sure you want to delete the variant "${variant.title || 'Untitled'}"? This cannot be undone.`)) {
// // // //       const toastId = toast.loading('Deleting variant...');
// // // //       const { success, error } = await deleteHeroVariant(variant);
// // // //       toast.dismiss(toastId);
// // // //       if (success) {
// // // //         toast.success('Variant deleted.');
// // // //       } else {
// // // //         toast.error(`Error: ${error}`);
// // // //       }
// // // //       // Real-time listener will handle the UI update
// // // //     }
// // // //   };

// // // //   const openModalToEdit = (variant) => {
// // // //     setSelectedVariant(variant);
// // // //     setIsModalOpen(true);
// // // //   };

// // // //   const openModalToCreate = () => {
// // // //     setSelectedVariant(null); // 'null' signifies "create mode"
// // // //     setIsModalOpen(true);
// // // //   };
  
// // // //   return (
// // // //     <motion.div
// // // //       initial={{ opacity: 0, y: 20 }}
// // // //       animate={{ opacity: 1, y: 0 }}
// // // //       className="space-y-6"
// // // //     >
// // // //       <Toaster position="bottom-center" />

// // // //       {/* Header */}
// // // //       <div className="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
// // // //         <div>
// // // //           <Link to="/admin/homepage-config" className="flex items-center gap-2 text-sm text-gray-500 hover:text-gray-900 mb-2">
// // // //             <ArrowLeft className="w-4 h-4" /> Back to Homepage Manager
// // // //           </Link>
// // // //           <h1 className="text-3xl font-bold text-gray-900">Edit Hero Section</h1>
// // // //         </div>
// // // //         <button
// // // //           onClick={openModalToCreate}
// // // //           className="flex items-center justify-center gap-2 bg-green-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-green-700 transition"
// // // //         >
// // // //           <Plus className="w-5 h-5" /> Create New Variant
// // // //         </button>
// // // //       </div>

// // // //       {/* Editor Content Area */}
// // // //       <div className="bg-white p-8 rounded-lg shadow border border-gray-200">
// // // //         <h2 className="text-xl font-semibold text-gray-800">Manage Hero Variants</h2>
// // // //         <p className="text-gray-500 mt-2 mb-6">
// // // //           Drag and drop variants to reorder them. You can have multiple active variants to create a carousel.
// // // //         </p>
        
// // // //         {isLoading ? (
// // // //           <div className="flex items-center justify-center h-48"><Loader2 className="w-8 h-8 animate-spin text-blue-600" /></div>
// // // //         ) : (
// // // //           <Reorder.Group axis="y" values={variants} onReorder={handleReorder} className="space-y-4">
// // // //             {variants.map(variant => (
// // // //               <Reorder.Item key={variant.id} value={variant} className="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4">
// // // //                 <GripVertical className="text-gray-400 cursor-grab" />
// // // //                 <div className="flex-1">
// // // //                   <h3 className="font-semibold text-gray-900">{variant.title || 'Untitled'}</h3>
// // // //                   <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${variant.variant_type === 'variant1' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}`}>
// // // //                     {variant.variant_type === 'variant1' ? 'Type 1: Icons' : 'Type 2: Photos'}
// // // //                   </span>
// // // //                 </div>
// // // //                 <div className="flex items-center gap-4">
// // // //                   <button onClick={() => handleToggleActive(variant)} title={variant.is_active ? 'Deactivate' : 'Activate'}>
// // // //                     {variant.is_active ? <Eye className="w-5 h-5 text-green-500" /> : <EyeOff className="w-5 h-5 text-gray-400" />}
// // // //                   </button>
// // // //                   <button onClick={() => openModalToEdit(variant)} className="text-sm font-medium text-blue-600 hover:text-blue-800">Edit</button>
// // // //                   <button onClick={() => handleDelete(variant)} className="text-sm font-medium text-red-600 hover:text-red-800">Delete</button>
// // // //                 </div>
// // // //               </Reorder.Item>
// // // //             ))}
// // // //           </Reorder.Group>
// // // //         )}
// // // //         {isSavingOrder && <p className="text-sm text-gray-500 mt-4 flex items-center gap-2"><Loader2 className="animate-spin" /> Saving new order...</p>}
// // // //       </div>
      
// // // //       {/* --- Editor Modal --- */}
// // // //       <AnimatePresence>
// // // //         {isModalOpen && (
// // // //           <VariantEditorModal
// // // //             variant={selectedVariant}
// // // //             onClose={() => setIsModalOpen(false)}
// // // //             onSave={loadData} // Refetch data on save
// // // //             allIcons={allIconNames}
// // // //           />
// // // //         )}
// // // //       </AnimatePresence>
// // // //     </motion.div>
// // // //   );
// // // // };

// // // // export default AdminHeroEditor;
// // // import React, { useState, useEffect, useCallback } from 'react';
// // // import { Link } from 'react-router-dom';
// // // import {
// // //   ArrowLeft, Save, Loader2, Plus, Trash2, Eye, EyeOff, GripVertical, Image as ImageIcon, UploadCloud
// // // } from 'lucide-react';
// // // import { motion, AnimatePresence, Reorder } from 'framer-motion';
// // // import { useForm, useFieldArray, Controller } from 'react-hook-form';
// // // import {
// // //   getHeroVariantsAdmin,
// // //   subscribeToHeroChanges,
// // //   updateHeroVariantsOrder,
// // //   deleteHeroVariant,
// // //   saveHeroVariant,
// // // } from '../../../api/heroadmin';
// // // import { getStorageUrl } from '../../../hooks/useHomepageData';
// // // import { Icon } from '../../../components/common/IconMap';
// // // import toast, { Toaster } from 'react-hot-toast';
// // // import { useAuth } from '../../../context/AuthContext'; // We need the user ID for uploads

// // // // --- Reusable Form Components ---
// // // const FormInput = ({ label, name, register, errors, ...rest }) => (
// // //   <div className="flex flex-col">
// // //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// // //     <input id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} />
// // //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// // //   </div>
// // // );

// // // const FormTextarea = ({ label, name, register, errors, ...rest }) => (
// // //   <div className="flex flex-col">
// // //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// // //     <textarea id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} rows="3" />
// // //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// // //   </div>
// // // );

// // // const FormToggle = ({ label, name, control }) => (
// // //   <Controller
// // //     name={name}
// // //     control={control}
// // //     render={({ field: { value, onChange } }) => (
// // //       <label className="flex items-center justify-between cursor-pointer p-2 bg-gray-50 rounded-md border">
// // //         <span className="text-sm font-medium text-gray-700">{label}</span>
// // //         <button
// // //           type="button"
// // //           onClick={() => onChange(!value)}
// // //           className={`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out ${value ? 'bg-blue-600' : 'bg-gray-200'}`}
// // //         >
// // //           <span className={`inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${value ? 'translate-x-5' : 'translate-x-0'}`} />
// // //         </button>
// // //       </label>
// // //     )}
// // //   />
// // // );

// // // // --- Advanced Image Uploader Component ---
// // // const ImageUpload = ({ control, name, defaultValue }) => {
// // //   // defaultValue is the media_assets object
// // //   const [preview, setPreview] = useState(getStorageUrl(defaultValue));

// // //   return (
// // //     <Controller
// // //       name={name}
// // //       control={control}
// // //       // Store the essential info in the form state
// // //       defaultValue={{ 
// // //         media_id: defaultValue?.id || null,
// // //         file: null,
// // //         originalMediaId: defaultValue?.id || null, 
// // //       }}
// // //       render={({ field: { onChange, value } }) => {
// // //         const handleFileChange = (e) => {
// // //           const file = e.target.files[0];
// // //           if (file) {
// // //             setPreview(URL.createObjectURL(file));
// // //             // 'file' will be caught by our API to trigger an upload
// // //             // 'originalMediaId' is crucial for deleting the old file
// // //             onChange({ 
// // //               media_id: null, // This is now a new file
// // //               file: file, 
// // //               originalMediaId: defaultValue?.id || null 
// // //             });
// // //           }
// // //         };

// // //         return (
// // //           <div className="flex flex-col items-center gap-2 p-2 border border-dashed rounded-md">
// // //             {preview ? (
// // //               <img src={preview} alt="Preview" className="w-24 h-24 object-cover rounded-md" />
// // //             ) : (
// // //               <div className="w-24 h-24 bg-gray-100 rounded-md flex items-center justify-center">
// // //                 <ImageIcon className="w-8 h-8 text-gray-400" />
// // //               </div>
// // //             )}
// // //             <input
// // //               type="file"
// // //               id={`file-upload-${name}`}
// // //               className="hidden"
// // //               accept="image/png, image/jpeg, image/webp"
// // //               onChange={handleFileChange}
// // //             />
// // //             <label
// // //               htmlFor={`file-upload-${name}`}
// // //               className="cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800 p-2 rounded-md bg-blue-50 hover:bg-blue-100 w-full text-center"
// // //             >
// // //               {value?.file ? 'File Selected' : 'Change Image'}
// // //             </label>
// // //           </div>
// // //         )
// // //       }}
// // //     />
// // //   );
// // // };


// // // // --- Hero Variant Editor Modal ---
// // // const VariantEditorModal = ({ variant, onClose, onSave, allIcons }) => {
// // //   const { user } = useAuth();
// // //   const { register, handleSubmit, control, watch, reset, formState: { errors, isSubmitting } } = useForm({
// // //     // Set default values from the variant data, or empty for creation
// // //     defaultValues: variant ? {
// // //       ...variant,
// // //       // Ensure nested fields are populated correctly
// // //       hero_variant1_icons: variant.hero_variant1_icons || [],
// // //       hero_variant2_photos: (variant.hero_variant2_photos || []).map(p => ({
// // //         ...p,
// // //         file: null,
// // //         originalMediaId: p.media_assets?.id || null,
// // //         media_id: p.media_assets?.id || null // Pass the media_id
// // //       })),
// // //     } : {
// // //       title: '',
// // //       subtitle: '',
// // //       paragraph: '',
// // //       variant_type: 'variant1',
// // //       is_active: true,
// // //       hero_variant1_icons: [],
// // //       hero_variant2_photos: [],
// // //     },
// // //   });

// // //   const selectedVariantType = watch('variant_type');

// // //   const { fields: iconFields, append: appendIcon, remove: removeIcon } = useFieldArray({
// // //     control,
// // //     name: 'hero_variant1_icons',
// // //   });

// // //   const { fields: photoFields, append: appendPhoto, remove: removePhoto } = useFieldArray({
// // //     control,
// // //     name: 'hero_variant2_photos',
// // //   });

// // //   const onSubmit = async (data) => {
// // //     const toastId = toast.loading(variant?.id ? 'Updating variant...' : 'Creating variant...');
    
// // //     // We pass the *entire* form data and user ID to the API function
// // //     const { success, error } = await saveHeroVariant(data, user.id);
    
// // //     toast.dismiss(toastId);
// // //     if (success) {
// // //       toast.success('Variant saved successfully!');
// // //       onSave(); // This will trigger a refetch in the parent
// // //       onClose(); // Close the modal
// // //     } else {
// // //       toast.error(`Error: ${error}`);
// // //     }
// // //   };
  
// // //   // Reset form if variant data changes (e.g., opening modal for a new item)
// // //   useEffect(() => {
// // //      reset(variant ? {
// // //       ...variant,
// // //       hero_variant1_icons: variant.hero_variant1_icons || [],
// // //       hero_variant2_photos: (variant.hero_variant2_photos || []).map(p => ({
// // //         ...p,
// // //         file: null,
// // //         originalMediaId: p.media_assets?.id || null,
// // //         media_id: p.media_assets?.id || null
// // //       })),
// // //     } : {
// // //       title: '',
// // //       subtitle: '',
// // //       paragraph: '',
// // //       variant_type: 'variant1',
// // //       is_active: true,
// // //       hero_variant1_icons: [],
// // //       hero_variant2_photos: [],
// // //     });
// // //   }, [variant, reset]);

// // //   return (
// // //     <motion.div
// // //       initial={{ opacity: 0 }}
// // //       animate={{ opacity: 1 }}
// // //       exit={{ opacity: 0 }}
// // //       className="fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4"
// // //       onClick={onClose}
// // //     >
// // //       <motion.div
// // //         initial={{ y: 50, scale: 0.95 }}
// // //         animate={{ y: 0, scale: 1 }}
// // //         exit={{ y: 50, scale: 0.95 }}
// // //         className="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"
// // //         onClick={e => e.stopPropagation()}
// // //       >
// // //         <div className="flex justify-between items-center p-6 border-b">
// // //           <h2 className="text-2xl font-bold text-gray-900">
// // //             {variant?.id ? 'Edit Hero Variant' : 'Create New Hero Variant'}
// // //           </h2>
// // //           <button onClick={onClose} className="text-gray-400 hover:text-gray-700 p-2">&times;</button>
// // //         </div>

// // //         <form onSubmit={handleSubmit(onSubmit)} className="flex-1 overflow-y-auto p-6 space-y-6">
// // //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
// // //             <FormInput label="Title" name="title" register={register} errors={errors} />
// // //             <FormInput label="Subtitle" name="subtitle" register={register} errors={errors} />
// // //           </div>
// // //           <FormTextarea label="Paragraph" name="paragraph" register={register} errors={errors} />
          
// // //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
// // //             <Controller
// // //               name="variant_type"
// // //               control={control}
// // //               render={({ field }) => (
// // //                 <div className="flex flex-col">
// // //                   <label className="mb-2 text-sm font-medium text-gray-700">Variant Type</label>
// // //                   <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
// // //                     <option value="variant1">Variant 1 (Icons)</option>
// // //                     <option value="variant2">Variant 2 (Photos)</option>
// // //                   </select>
// // //                 </div>
// // //               )}
// // //             />
// // //             <FormToggle label="Is Active?" name="is_active" control={control} />
// // //           </div>

// // //           {/* --- Conditional Fields --- */}
// // //           <AnimatePresence mode="wait">
// // //             {selectedVariantType === 'variant1' ? (
// // //               <motion.div
// // //                 key="variant1"
// // //                 initial={{ opacity: 0, y: 10 }}
// // //                 animate={{ opacity: 1, y: 0 }}
// // //                 exit={{ opacity: 0, y: -10 }}
// // //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// // //               >
// // //                 <h3 className="font-semibold text-gray-800">Variant 1: Icons</h3>
// // //                 {iconFields.map((field, index) => (
// // //                   <div key={field.id} className="grid grid-cols-1 md:grid-cols-3 gap-2 p-2 border-b items-end">
// // //                     <Controller
// // //                       name={`hero_variant1_icons.${index}.icon_name`}
// // //                       control={control}
// // //                       render={({ field }) => (
// // //                         <div className="flex flex-col">
// // //                            <label className="mb-2 text-sm font-medium text-gray-700">Icon</label>
// // //                           <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
// // //                             <option value="">Select Icon</option>
// // //                             {allIcons.map(iconName => <option key={iconName} value={iconName}>{iconName}</option>)}
// // //                           </select>
// // //                         </div>
// // //                       )}
// // //                     />
// // //                     <FormInput
// // //                       label="Position (JSON)"
// // //                       name={`hero_variant1_icons.${index}.position`}
// // //                       register={register}
// // //                       errors={errors}
// // //                       placeholder='{"top": "10%", "left": "5%"}'
// // //                     />
// // //                     <button type="button" onClick={() => removeIcon(index)} className="text-red-500 hover:text-red-700 p-2">
// // //                       <Trash2 className="w-5 h-5" />
// // //                     </button>
// // //                   </div>
// // //                 ))}
// // //                 <button type="button" onClick={() => appendIcon({ icon_name: '', position: '{"top": "0", "left": "0"}' })} className="text-sm font-medium text-blue-600 hover:text-blue-800">
// // //                   <Plus className="w-4 h-4 inline mr-1" /> Add Icon
// // //                 </button>
// // //               </motion.div>
// // //             ) : (
// // //               <motion.div
// // //                 key="variant2"
// // //                 initial={{ opacity: 0, y: 10 }}
// // //                 animate={{ opacity: 1, y: 0 }}
// // //                 exit={{ opacity: 0, y: -10 }}
// // //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// // //               >
// // //                 <h3 className="font-semibold text-gray-800">Variant 2: Photos</h3>
// // //                 <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
// // //                   {photoFields.map((field, index) => (
// // //                     <div key={field.id} className="space-y-2 p-2 border rounded-md relative">
// // //                       <ImageUpload
// // //                         name={`hero_variant2_photos.${index}`}
// // //                         control={control}
// // //                         defaultValue={field.media_assets} // Pass the full media_assets object
// // //                       />
// // //                       <FormInput
// // //                         label="Rotation"
// // //                         name={`hero_variant2_photos.${index}.rotation`}
// // //                         register={register}
// // //                         errors={errors}
// // //                         type="number"
// // //                       />
// // //                       <FormInput
// // //                         label="Delay (s)"
// // //                         name={`hero_variant2_photos.${index}.delay`}
// // //                         register={register}
// // //                         errors={errors}
// // //                         type="number"
// // //                         step="0.1"
// // //                       />
// // //                       <button
// // //                         type="button"
// // //                         onClick={() => removePhoto(index)}
// // //                         className="absolute -top-2 -right-2 bg-red-500 text-white p-1 rounded-full shadow"
// // //                       >
// // //                         <Trash2 className="w-4 h-4" />
// // //                       </button>
// // //                     </div>
// // //                   ))}
// // //                   <button
// // //                     type="button"
// // //                     onClick={() => appendPhoto({ media_id: null, rotation: 0, delay: 0, file: null, originalMediaId: null })}
// // //                     className="flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-500 hover:border-blue-500 hover:text-blue-500 h-full"
// // //                   >
// // //                     <UploadCloud className="w-8 h-8" />
// // //                     <span className="text-sm mt-2">Add Photo</span>
// // //                   </button>
// // //                 </div>
// // //               </motion.div>
// // //             )}
// // //           </AnimatePresence>
// // //         </form>

// // //         <div className="flex justify-end items-center p-6 border-t gap-4">
// // //           <button onClick={onClose} className="px-4 py-2 rounded-md text-gray-600 hover:bg-gray-100">Cancel</button>
// // //           <button
// // //             onClick={handleSubmit(onSubmit)}
// // //             disabled={isSubmitting}
// // //             className="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-blue-700 transition disabled:opacity-50"
// // //           >
// // //             {isSubmitting ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
// // //             {isSubmitting ? 'Saving...' : 'Save Changes'}
// // //           </button>
// // //         </div>
// // //       </motion.div>
// // //     </motion.div>
// // //   );
// // // };

// // // // --- Main Editor Component ---
// // // const AdminHeroEditor = () => {
// // //   const [variants, setVariants] = useState([]);
// // //   const [isLoading, setIsLoading] = useState(true);
// // //   const [isSavingOrder, setIsSavingOrder] = useState(false);
// // //   const [isModalOpen, setIsModalOpen] = useState(false);
// // //   const [selectedVariant, setSelectedVariant] = useState(null);

// // //   // Get all icon names from our IconMap for the dropdown
// // //   const allIconNames = Object.keys(Icon);

// // //   // Fetch and subscribe to data
// // //   const loadData = useCallback(async () => {
// // //     setIsLoading(true);
// // //     const data = await getHeroVariantsAdmin();
// // //     setVariants(data);
// // //     setIsLoading(false);
// // //   }, []);

// // //   useEffect(() => {
// // //     loadData();
// // //     const subscription = subscribeToHeroChanges(loadData);
// // //     return () => subscription.unsubscribe();
// // //   }, [loadData]);

// // //   // --- Handlers ---
// // //   const handleReorder = async (newOrder) => {
// // //     setVariants(newOrder); // Update UI immediately
// // //     setIsSavingOrder(true);
// // //     await updateHeroVariantsOrder(newOrder);
// // //     setIsSavingOrder(false);
// // //     toast.success('Hero order updated!');
// // //   };
  
// // //   const handleToggleActive = async (variant) => {
// // //     const toastId = toast.loading(variant.is_active ? 'Deactivating...' : 'Activating...');
// // //     // We just call saveHeroVariant with the *only* change
// // //     await saveHeroVariant({ ...variant, is_active: !variant.is_active });
// // //     toast.dismiss(toastId);
// // //     toast.success('Visibility updated!');
// // //     // Real-time listener will handle the UI update
// // //   };
  
// // //   const handleDelete = async (variant) => {
// // //     if (window.confirm(`Are you sure you want to delete the variant "${variant.title || 'Untitled'}"? This cannot be undone.`)) {
// // //       const toastId = toast.loading('Deleting variant...');
// // //       const { success, error } = await deleteHeroVariant(variant);
// // //       toast.dismiss(toastId);
// // //       if (success) {
// // //         toast.success('Variant deleted.');
// // //       } else {
// // //         toast.error(`Error: ${error}`);
// // //       }
// // //       // Real-time listener will handle the UI update
// // //     }
// // //   };

// // //   const openModalToEdit = (variant) => {
// // //     // Deep copy the variant to prevent mutation of the list state
// // //     setSelectedVariant(JSON.parse(JSON.stringify(variant)));
// // //     setIsModalOpen(true);
// // //   };

// // //   const openModalToCreate = () => {
// // //     setSelectedVariant(null); // 'null' signifies "create mode"
// // //     setIsModalOpen(true);
// // //   };
  
// // //   return (
// // //     <motion.div
// // //       initial={{ opacity: 0, y: 20 }}
// // //       animate={{ opacity: 1, y: 0 }}
// // //       className="space-y-6"
// // //     >
// // //       <Toaster position="bottom-center" />

// // //       {/* Header */}
// // //       <div className="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
// // //         <div>
// // //           <Link to="/admin/homepage-config" className="flex items-center gap-2 text-sm text-gray-500 hover:text-gray-900 mb-2">
// // //             <ArrowLeft className="w-4 h-4" /> Back to Homepage Manager
// // //           </Link>
// // //           <h1 className="text-3xl font-bold text-gray-900">Edit Hero Section</h1>
// // //         </div>
// // //         <button
// // //           onClick={openModalToCreate}
// // //           className="flex items-center justify-center gap-2 bg-green-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-green-700 transition"
// // //         >
// // //           <Plus className="w-5 h-5" /> Create New Variant
// // //         </button>
// // //       </div>

// // //       {/* Editor Content Area */}
// // //       <div className="bg-white p-8 rounded-lg shadow border border-gray-200">
// // //         <h2 className="text-xl font-semibold text-gray-800">Manage Hero Variants</h2>
// // //         <p className="text-gray-500 mt-2 mb-6">
// // //           Drag and drop variants to reorder them. You can have multiple active variants to create a carousel.
// // //         </p>
        
// // //         {isLoading ? (
// // //           <div className="flex items-center justify-center h-48"><Loader2 className="w-8 h-8 animate-spin text-blue-600" /></div>
// // //         ) : (
// // //           <Reorder.Group axis="y" values={variants} onReorder={handleReorder} className="space-y-4">
// // //             {variants.map(variant => (
// // //               <Reorder.Item key={variant.id} value={variant} className="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4">
// // //                 <GripVertical className="text-gray-400 cursor-grab" />
// // //                 <div className="flex-1">
// // //                   <h3 className="font-semibold text-gray-900">{variant.title || 'Untitled'}</h3>
// // //                   <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${variant.variant_type === 'variant1' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}`}>
// // //                     {variant.variant_type === 'variant1' ? 'Type 1: Icons' : 'Type 2: Photos'}
// // //                   </span>
// // //                 </div>
// // //                 <div className="flex items-center gap-4">
// // //                   <button onClick={() => handleToggleActive(variant)} title={variant.is_active ? 'Deactivate' : 'Activate'}>
// // //                     {variant.is_active ? <Eye className="w-5 h-5 text-green-500" /> : <EyeOff className="w-5 h-5 text-gray-400" />}
// // //                   </button>
// // //                   <button onClick={() => openModalToEdit(variant)} className="text-sm font-medium text-blue-600 hover:text-blue-800">Edit</button>
// // //                   <button onClick={() => handleDelete(variant)} className="text-sm font-medium text-red-600 hover:text-red-800">Delete</button>
// // //                 </div>
// // //               </Reorder.Item>
// // //             ))}
// // //           </Reorder.Group>
// // //         )}
// // //         {isSavingOrder && <p className="text-sm text-gray-500 mt-4 flex items-center gap-2"><Loader2 className="animate-spin" /> Saving new order...</p>}
// // //       </div>
      
// // //       {/* --- Editor Modal --- */}
// // //       <AnimatePresence>
// // //         {isModalOpen && (
// // //           <VariantEditorModal
// // //             variant={selectedVariant}
// // //             onClose={() => setIsModalOpen(false)}
// // //             onSave={loadData} // Refetch data on save
// // //             allIcons={allIconNames}
// // //           />
// // //         )}
// // //       </AnimatePresence>
// // //     </motion.div>
// // //   );
// // // };

// // // export default AdminHeroEditor;





// // import React, { useState, useEffect, useCallback } from 'react';
// // import { Link } from 'react-router-dom';
// // import {
// //   ArrowLeft, Save, Loader2, Plus, Trash2, Eye, EyeOff, GripVertical, Image as ImageIcon, UploadCloud
// // } from 'lucide-react';
// // import { motion, AnimatePresence, Reorder } from 'framer-motion';
// // import { useForm, useFieldArray, Controller } from 'react-hook-form';
// // import {
// //   getHeroVariantsAdmin,
// //   subscribeToHeroChanges,
// //   updateHeroVariantsOrder,
// //   deleteHeroVariant,
// //   saveHeroVariant,
// // } from '../../../api/heroadmin';
// // import { getStorageUrl } from '../../../hooks/useHomepageData';
// // import { Icon } from '../../../components/common/IconMap';
// // import toast, { Toaster } from 'react-hot-toast';
// // import { useAuth } from '../../../context/AuthContext'; // We need the user ID for uploads

// // // --- Reusable Form Components ---
// // const FormInput = ({ label, name, register, errors, ...rest }) => (
// //   <div className="flex flex-col">
// //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// //     <input id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} />
// //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// //   </div>
// // );

// // // --- *** NEW JSON Form Input *** ---
// // // This component handles the [object Object] error
// // const FormJsonInput = ({ label, name, control, errors, placeholder }) => (
// //   <Controller
// //     name={name}
// //     control={control}
// //     render={({ field }) => (
// //       <div className="flex flex-col">
// //         <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// //         <input
// //           id={name}
// //           value={
// //             // Convert object to string for display, or show empty string
// //             field.value ? JSON.stringify(field.value) : ''
// //           }
// //           onChange={(e) => {
// //             // Try to parse the string back into an object
// //             try {
// //               field.onChange(JSON.parse(e.target.value));
// //             } catch (err) {
// //               // If invalid JSON, just pass the string (form validation will catch it)
// //               field.onChange(e.target.value);
// //             }
// //           }}
// //           placeholder={placeholder}
// //           className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500 font-mono text-sm`}
// //         />
// //         {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// //       </div>
// //     )}
// //     // Add a rule to ensure it's valid JSON
// //     rules={{
// //       validate: value => {
// //         try {
// //           if (typeof value === 'object' && value !== null) return true;
// //           JSON.parse(value);
// //           return true;
// //         } catch (e) {
// //           return 'Must be valid JSON';
// //         }
// //       }
// //     }}
// //   />
// // );


// // const FormTextarea = ({ label, name, register, errors, ...rest }) => (
// //   <div className="flex flex-col">
// //     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
// //     <textarea id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} rows="3" />
// //     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
// //   </div>
// // );

// // const FormToggle = ({ label, name, control }) => (
// //   <Controller
// //     name={name}
// //     control={control}
// //     render={({ field: { value, onChange } }) => (
// //       <label className="flex items-center justify-between cursor-pointer p-2 bg-gray-50 rounded-md border">
// //         <span className="text-sm font-medium text-gray-700">{label}</span>
// //         <button
// //           type="button"
// //           onClick={() => onChange(!value)}
// //           className={`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out ${value ? 'bg-blue-600' : 'bg-gray-200'}`}
// //         >
// //           <span className={`inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${value ? 'translate-x-5' : 'translate-x-0'}`} />
// //         </button>
// //       </label>
// //     )}
// //   />
// // );

// // // --- Advanced Image Uploader Component ---
// // const ImageUpload = ({ control, name, defaultValue }) => {
// //   // defaultValue is the media_assets object
// //   const [preview, setPreview] = useState(getStorageUrl(defaultValue));

// //   return (
// //     <Controller
// //       name={name}
// //       control={control}
// //       // Store the essential info in the form state
// //       defaultValue={{ 
// //         media_id: defaultValue?.id || null,
// //         file: null,
// //         originalMediaId: defaultValue?.id || null, 
// //       }}
// //       render={({ field: { onChange, value } }) => {
// //         const handleFileChange = (e) => {
// //           const file = e.target.files[0];
// //           if (file) {
// //             setPreview(URL.createObjectURL(file));
// //             // 'file' will be caught by our API to trigger an upload
// //             // 'originalMediaId' is crucial for deleting the old file
// //             onChange({ 
// //               media_id: null, // This is now a new file
// //               file: file, 
// //               originalMediaId: value?.originalMediaId || defaultValue?.id || null 
// //             });
// //           }
// //         };

// //         return (
// //           <div className="flex flex-col items-center gap-2 p-2 border border-dashed rounded-md">
// //             {preview ? (
// //               <img src={preview} alt="Preview" className="w-24 h-24 object-cover rounded-md" />
// //             ) : (
// //               <div className="w-24 h-24 bg-gray-100 rounded-md flex items-center justify-center">
// //                 <ImageIcon className="w-8 h-8 text-gray-400" />
// //               </div>
// //             )}
// //             <input
// //               type="file"
// //               id={`file-upload-${name}`}
// //               className="hidden"
// //               accept="image/png, image/jpeg, image/webp"
// //               onChange={handleFileChange}
// //             />
// //             <label
// //               htmlFor={`file-upload-${name}`}
// //               className="cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800 p-2 rounded-md bg-blue-50 hover:bg-blue-100 w-full text-center"
// //             >
// //               {value?.file ? 'File Selected' : 'Change Image'}
// //             </label>
// //           </div>
// //         )
// //       }}
// //     />
// //   );
// // };


// // // --- Hero Variant Editor Modal ---
// // const VariantEditorModal = ({ variant, onClose, onSave, allIcons }) => {
// //   const { user } = useAuth();
// //   const { register, handleSubmit, control, watch, reset, formState: { errors, isSubmitting } } = useForm();

// //   // This effect correctly sets the form's default values when the modal opens or variant changes
// //   useEffect(() => {
// //      reset(variant ? {
// //       ...variant,
// //       // Ensure nested fields are populated correctly
// //       hero_variant1_icons: variant.hero_variant1_icons || [],
// //       hero_variant2_photos: (variant.hero_variant2_photos || []).map(p => ({
// //         ...p,
// //         file: null,
// //         originalMediaId: p.media_assets?.id || null,
// //         media_id: p.media_assets?.id || null // Pass the media_id
// //       })),
// //     } : {
// //       // Defaults for a new variant
// //       title: '',
// //       subtitle: '',
// //       paragraph: '',
// //       variant_type: 'variant1',
// //       is_active: true,
// //       hero_variant1_icons: [],
// //       hero_variant2_photos: [],
// //     });
// //   }, [variant, reset]);

// //   const selectedVariantType = watch('variant_type');

// //   const { fields: iconFields, append: appendIcon, remove: removeIcon } = useFieldArray({
// //     control,
// //     name: 'hero_variant1_icons',
// //   });

// //   const { fields: photoFields, append: appendPhoto, remove: removePhoto } = useFieldArray({
// //     control,
// //     name: 'hero_variant2_photos',
// //   });

// //   const onSubmit = async (data) => {
// //     const toastId = toast.loading(variant?.id ? 'Updating variant...' : 'Creating variant...');
    
// //     // We pass the *entire* form data and user ID to the API function
// //    //
// //     const { success, error } = await saveHeroVariant(data, '01e31b35-ed86-423b-abd5-01e97bbba857');
    
// //     toast.dismiss(toastId);
// //     if (success) {
// //       toast.success('Variant saved successfully!');
// //       onSave(); // This will trigger a refetch in the parent
// //       onClose(); // Close the modal
// //     } else {
// //       toast.error(`Error: ${error}`);
// //     }
// //   };

// //   return (
// //     <motion.div
// //       initial={{ opacity: 0 }}
// //       animate={{ opacity: 1 }}
// //       exit={{ opacity: 0 }}
// //       className="fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4"
// //       onClick={onClose}
// //     >
// //       <motion.div
// //         initial={{ y: 50, scale: 0.95 }}
// //         animate={{ y: 0, scale: 1 }}
// //         exit={{ y: 50, scale: 0.95 }}
// //         className="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"
// //         onClick={e => e.stopPropagation()}
// //       >
// //         <div className="flex justify-between items-center p-6 border-b">
// //           <h2 className="text-2xl font-bold text-gray-900">
// //             {variant?.id ? 'Edit Hero Variant' : 'Create New Hero Variant'}
// //           </h2>
// //           <button onClick={onClose} className="text-gray-400 hover:text-gray-700 p-2">&times;</button>
// //         </div>

// //         <form onSubmit={handleSubmit(onSubmit)} className="flex-1 overflow-y-auto p-6 space-y-6">
// //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
// //             <FormInput label="Title" name="title" register={register} errors={errors} />
// //             <FormInput label="Subtitle" name="subtitle" register={register} errors={errors} />
// //           </div>
// //           <FormTextarea label="Paragraph" name="paragraph" register={register} errors={errors} />
          
// //           <div className="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
// //             <Controller
// //               name="variant_type"
// //               control={control}
// //               render={({ field }) => (
// //                 <div className="flex flex-col">
// //                   <label className="mb-2 text-sm font-medium text-gray-700">Variant Type</label>
// //                   <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
// //                     <option value="variant1">Variant 1 (Icons)</option>
// //                     <option value="variant2">Variant 2 (Photos)</option>
// //                   </select>
// //                 </div>
// //               )}
// //             />
// //             <FormToggle label="Is Active?" name="is_active" control={control} />
// //           </div>

// //           {/* --- Conditional Fields --- */}
// //           <AnimatePresence mode="wait">
// //             {selectedVariantType === 'variant1' ? (
// //               <motion.div
// //                 key="variant1"
// //                 initial={{ opacity: 0, y: 10 }}
// //                 animate={{ opacity: 1, y: 0 }}
// //                 exit={{ opacity: 0, y: -10 }}
// //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// //               >
// //                 <h3 className="font-semibold text-gray-800">Variant 1: Icons</h3>
// //                 {iconFields.map((field, index) => (
// //                   <div key={field.id} className="grid grid-cols-1 md:grid-cols-3 gap-2 p-2 border-b items-end">
// //                     <Controller
// //                       name={`hero_variant1_icons.${index}.icon_name`}
// //                       control={control}
// //                       render={({ field }) => (
// //                         <div className="flex flex-col">
// //                            <label className="mb-2 text-sm font-medium text-gray-700">Icon</label>
// //                           <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
// //                             <option value="">Select Icon</option>
// //                             {/* This should now work correctly */}
// //                             {allIcons.map(iconName => <option key={iconName} value={iconName}>{iconName}</option>)}
// //                           </select>
// //                         </div>
// //                       )}
// //                     />
                    
// //                     {/* --- FIX for [object Object] --- */}
// //                     <FormJsonInput
// //                       label="Position (JSON)"
// //                       name={`hero_variant1_icons.${index}.position`}
// //                       control={control}
// //                       errors={errors}
// //                       placeholder='{"top": "10%"}'
// //                     />

// //                     <button type="button" onClick={() => removeIcon(index)} className="text-red-500 hover:text-red-700 p-2">
// //                       <Trash2 className="w-5 h-5" />
// //                     </button>
// //                   </div>
// //                 ))}
// //                 <button type="button" onClick={() => appendIcon({ icon_name: '', position: { top: '0', left: '0' } })} className="text-sm font-medium text-blue-600 hover:text-blue-800">
// //                   <Plus className="w-4 h-4 inline mr-1" /> Add Icon
// //                 </button>
// //               </motion.div>
// //             ) : (
// //               <motion.div
// //                 key="variant2"
// //                 initial={{ opacity: 0, y: 10 }}
// //                 animate={{ opacity: 1, y: 0 }}
// //                 exit={{ opacity: 0, y: -10 }}
// //                 className="p-4 border border-gray-200 rounded-lg space-y-4"
// //               >
// //                 <h3 className="font-semibold text-gray-800">Variant 2: Photos</h3>
// //                 <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
// //                   {photoFields.map((field, index) => (
// //                     <div key={field.id} className="space-y-2 p-2 border rounded-md relative">
// //                       <ImageUpload
// //                         name={`hero_variant2_photos.${index}`}
// //                         control={control}
// //                         defaultValue={field.media_assets} // Pass the full media_assets object
// //                       />
// //                       <FormInput
// //                         label="Rotation"
// //                         name={`hero_variant2_photos.${index}.rotation`}
// //                         register={register}
// //                         errors={errors}
// //                         type="number"
// //                       />
// //                       <FormInput
// //                         label="Delay (s)"
// //                         name={`hero_variant2_photos.${index}.delay`}
// //                         register={register}
// //                         errors={errors}
// //                         type="number"
// //                         step="0.1"
// //                       />
// //                       <button
// //                         type="button"
// //                         onClick={() => removePhoto(index)}
// //                         className="absolute -top-2 -right-2 bg-red-500 text-white p-1 rounded-full shadow"
// //                       >
// //                         <Trash2 className="w-4 h-4" />
// //                       </button>
// //                     </div>
// //                   ))}
// //                   <button
// //                     type="button"
// //                     onClick={() => appendPhoto({ media_id: null, rotation: 0, delay: 0, file: null, originalMediaId: null })}
// //                     className="flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-500 hover:border-blue-500 hover:text-blue-500 h-full"
// //                   >
// //                     <UploadCloud className="w-8 h-8" />
// //                     <span className="text-sm mt-2">Add Photo</span>
// //                   </button>
// //                 </div>
// //               </motion.div>
// //             )}
// //           </AnimatePresence>
// //         </form>

// //         <div className="flex justify-end items-center p-6 border-t gap-4">
// //           <button onClick={onClose} className="px-4 py-2 rounded-md text-gray-600 hover:bg-gray-100">Cancel</button>
// //           <button
// //             onClick={handleSubmit(onSubmit)}
// //             disabled={isSubmitting}
// //             className="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-blue-700 transition disabled:opacity-50"
// //           >
// //             {isSubmitting ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
// //             {isSubmitting ? 'Saving...' : 'Save Changes'}
// //           </button>
// //         </div>
// //       </motion.div>
// //     </motion.div>
// //   );
// // };

// // // --- Main Editor Component ---
// // const AdminHeroEditor = () => {
// //   const [variants, setVariants] = useState([]);
// //   const [isLoading, setIsLoading] = useState(true);
// //   const [isSavingOrder, setIsSavingOrder] = useState(false);
// //   const [isModalOpen, setIsModalOpen] = useState(false);
// //   const [selectedVariant, setSelectedVariant] = useState(null);

// //   // Get all icon names from our IconMap for the dropdown
// //   // FIX: Ensure Icon is imported and Object.keys is used
// //   const allIconNames = Object.keys(Icon);

// //   // Fetch and subscribe to data
// //   const loadData = useCallback(async () => {
// //     setIsLoading(true);
// //     const data = await getHeroVariantsAdmin();
// //     setVariants(data);
// //     setIsLoading(false);
// //   }, []);

// //   useEffect(() => {
// //     loadData();
// //     const subscription = subscribeToHeroChanges(loadData);
// //     return () => subscription.unsubscribe();
// //   }, [loadData]);

// //   // --- Handlers ---
// //   const handleReorder = async (newOrder) => {
// //     setVariants(newOrder); // Update UI immediately
// //     setIsSavingOrder(true);
// //     await updateHeroVariantsOrder(newOrder);
// //     setIsSavingOrder(false);
// //     toast.success('Hero order updated!');
// //   };
  
// //   const handleToggleActive = async (variant) => {
// //     const toastId = toast.loading(variant.is_active ? 'Deactivating...' : 'Activating...');
// //     // We just call saveHeroVariant with the *only* change
// //     // We need the user for the upload logic, but it's not used here
// //     await saveHeroVariant({ ...variant, is_active: !variant.is_active }, null); 
// //     toast.dismiss(toastId);
// //     toast.success('Visibility updated!');
// //     // Real-time listener will handle the UI update
// //   };
  
// //   const handleDelete = async (variant) => {
// //     if (window.confirm(`Are you sure you want to delete the variant "${variant.title || 'Untitled'}"? This cannot be undone.`)) {
// //       const toastId = toast.loading('Deleting variant...');
// //       const { success, error } = await deleteHeroVariant(variant);
// //       toast.dismiss(toastId);
// //       if (success) {
// //         toast.success('Variant deleted.');
// //       } else {
// //         toast.error(`Error: ${error}`);
// //       }
// //       // Real-time listener will handle the UI update
// //     }
// //   };

// //   const openModalToEdit = (variant) => {
// //     // Deep copy the variant to prevent mutation of the list state
// //     setSelectedVariant(JSON.parse(JSON.stringify(variant)));
// //     setIsModalOpen(true);
// //   };

// //   const openModalToCreate = () => {
// //     setSelectedVariant(null); // 'null' signifies "create mode"
// //     setIsModalOpen(true);
// //   };
  
// //   return (
// //     <motion.div
// //       initial={{ opacity: 0, y: 20 }}
// //       animate={{ opacity: 1, y: 0 }}
// //       className="space-y-6"
// //     >
// //       <Toaster position="bottom-center" />

// //       {/* Header */}
// //       <div className="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
// //         <div>
// //           <Link to="/admin/homepage-config" className="flex items-center gap-2 text-sm text-gray-500 hover:text-gray-900 mb-2">
// //             <ArrowLeft className="w-4 h-4" /> Back to Homepage Manager
// //           </Link>
// //           <h1 className="text-3xl font-bold text-gray-900">Edit Hero Section</h1>
// //         </div>
// //         <button
// //           onClick={openModalToCreate}
// //           className="flex items-center justify-center gap-2 bg-green-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-green-700 transition"
// //         >
// //           <Plus className="w-5 h-5" /> Create New Variant
// //         </button>
// //       </div>

// //       {/* Editor Content Area */}
// //       <div className="bg-white p-8 rounded-lg shadow border border-gray-200">
// //         <h2 className="text-xl font-semibold text-gray-800">Manage Hero Variants</h2>
// //         <p className="text-gray-500 mt-2 mb-6">
// //           Drag and drop variants to reorder them. You can have multiple active variants to create a carousel.
// //         </p>
        
// //         {isLoading ? (
// //           <div className="flex items-center justify-center h-48"><Loader2 className="w-8 h-8 animate-spin text-blue-600" /></div>
// //         ) : (
// //           <Reorder.Group axis="y" values={variants} onReorder={handleReorder} className="space-y-4">
// //             {variants.map(variant => (
// //               <Reorder.Item key={variant.id} value={variant} className="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4">
// //                 <GripVertical className="text-gray-400 cursor-grab" />
// //                 <div className="flex-1">
// //                   <h3 className="font-semibold text-gray-900">{variant.title || 'Untitled'}</h3>
// //                   <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${variant.variant_type === 'variant1' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}`}>
// //                     {variant.variant_type === 'variant1' ? 'Type 1: Icons' : 'Type 2: Photos'}
// //                   </span>
// //                 </div>
// //                 <div className="flex items-center gap-4">
// //                   <button onClick={() => handleToggleActive(variant)} title={variant.is_active ? 'Deactivate' : 'Activate'}>
// //                     {variant.is_active ? <Eye className="w-5 h-5 text-green-500" /> : <EyeOff className="w-5 h-5 text-gray-400" />}
// //                   </button>
// //                   <button onClick={() => openModalToEdit(variant)} className="text-sm font-medium text-blue-600 hover:text-blue-800">Edit</button>
// //                   <button onClick={() => handleDelete(variant)} className="text-sm font-medium text-red-600 hover:text-red-800">Delete</button>
// //                 </div>
// //               </Reorder.Item>
// //             ))}
// //           </Reorder.Group>
// //         )}
// //         {isSavingOrder && <p className="text-sm text-gray-500 mt-4 flex items-center gap-2"><Loader2 className="animate-spin" /> Saving new order...</p>}
// //       </div>
      
// //       {/* --- Editor Modal --- */}
// //       <AnimatePresence>
// //         {isModalOpen && (
// //           <VariantEditorModal
// //             variant={selectedVariant}
// //             onClose={() => setIsModalOpen(false)}
// //             onSave={loadData} // Refetch data on save
// //             allIcons={allIconNames}
// //           />
// //         )}
// //       </AnimatePresence>
// //     </motion.div>
// //   );
// // };

// // export default AdminHeroEditor;


// import React, { useState, useEffect, useCallback } from 'react';
// import { Link } from 'react-router-dom';
// import {
//   ArrowLeft, Save, Loader2, Plus, Trash2, Eye, EyeOff, GripVertical, Image as ImageIcon, UploadCloud
// } from 'lucide-react';
// import { motion, AnimatePresence, Reorder } from 'framer-motion';
// import { useForm, useFieldArray, Controller } from 'react-hook-form';
// import {
//   getHeroVariantsAdmin,
//   subscribeToHeroChanges,
//   updateHeroVariantsOrder,
//   deleteHeroVariant,
//   saveHeroVariant,
// } from '../../../api/heroadmin';
// import { getStorageUrl } from '../../../hooks/useHomepageData';
// import { Icon } from '../../../components/common/IconMap'; // FIX: Ensure IconMap is imported
// import toast, { Toaster } from 'react-hot-toast';
// import { useAuth } from '../../../context/AuthContext'; // We need the user ID for uploads

// // --- Reusable Form Components ---
// const FormInput = ({ label, name, register, errors, ...rest }) => (
//   <div className="flex flex-col">
//     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
//     <input id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} />
//     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
//   </div>
// );

// // --- *** NEW JSON Form Input *** ---
// // This component handles the [object Object] error
// const FormJsonInput = ({ label, name, control, errors, placeholder }) => (
//   <Controller
//     name={name}
//     control={control}
//     render={({ field }) => (
//       <div className="flex flex-col">
//         <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
//         <input
//           id={name}
//           // --- FIX: Convert object to string for display ---
//           value={
//             typeof field.value === 'object' && field.value !== null
//               ? JSON.stringify(field.value)
//               : field.value || ''
//           }
//           onChange={(e) => {
//             // Pass the string value directly to react-hook-form
//             field.onChange(e.target.value);
//           }}
//           placeholder={placeholder}
//           className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500 font-mono text-sm`}
//         />
//         {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
//       </div>
//     )}
//     // Add a rule to ensure it's valid JSON before submitting
//     rules={{
//       validate: value => {
//         if (!value) return true; // Allow empty
//         try {
//           // Check if it's already an object (from defaultValues)
//           if (typeof value === 'object' && value !== null) return true;
//           // Check if it's a string that can be parsed
//           JSON.parse(value);
//           return true;
//         } catch (e) {
//           return 'Must be valid JSON';
//         }
//       }
//     }}
//   />
// );


// const FormTextarea = ({ label, name, register, errors, ...rest }) => (
//   <div className="flex flex-col">
//     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">{label}</label>
//     <textarea id={name} {...register(name)} {...rest} className={`p-2 border rounded-md ${errors[name] ? 'border-red-500' : 'border-gray-300'} focus:ring-blue-500 focus:border-blue-500`} rows="3" />
//     {errors[name] && <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>}
//   </div>
// );

// const FormToggle = ({ label, name, control }) => (
//   <Controller
//     name={name}
//     control={control}
//     render={({ field: { value, onChange } }) => (
//       <label className="flex items-center justify-between cursor-pointer p-2 bg-gray-50 rounded-md border">
//         <span className="text-sm font-medium text-gray-700">{label}</span>
//         <button
//           type="button"
//           onClick={() => onChange(!value)}
//           className={`relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out ${value ? 'bg-blue-600' : 'bg-gray-200'}`}
//         >
//           <span className={`inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out ${value ? 'translate-x-5' : 'translate-x-0'}`} />
//         </button>
//       </label>
//     )}
//   />
// );

// // --- Advanced Image Uploader Component ---
// const ImageUpload = ({ control, name, defaultValue }) => {
//   // defaultValue is the media_assets object
//   const [preview, setPreview] = useState(getStorageUrl(defaultValue));

//   return (
//     <Controller
//       name={name}
//       control={control}
//       // Store the essential info in the form state
//       defaultValue={{ 
//         media_id: defaultValue?.id || null,
//         file: null,
//         originalMediaId: defaultValue?.id || null, 
//       }}
//       render={({ field: { onChange, value } }) => {
//         const handleFileChange = (e) => {
//           const file = e.target.files[0];
//           if (file) {
//             setPreview(URL.createObjectURL(file));
//             // 'file' will be caught by our API to trigger an upload
//             // 'originalMediaId' is crucial for deleting the old file
//             onChange({ 
//               media_id: null, // This is now a new file
//               file: file, 
//               originalMediaId: value?.originalMediaId || defaultValue?.id || null 
//             });
//           }
//         };

//         return (
//           <div className="flex flex-col items-center gap-2 p-2 border border-dashed rounded-md">
//             {preview ? (
//               <img src={preview} alt="Preview" className="w-24 h-24 object-cover rounded-md" />
//             ) : (
//               <div className="w-24 h-24 bg-gray-100 rounded-md flex items-center justify-center">
//                 <ImageIcon className="w-8 h-8 text-gray-400" />
//               </div>
//             )}
//             <input
//               type="file"
//               id={`file-upload-${name}`}
//               className="hidden"
//               accept="image/png, image/jpeg, image/webp"
//               onChange={handleFileChange}
//             />
//             <label
//               htmlFor={`file-upload-${name}`}
//               className="cursor-pointer text-sm font-medium text-blue-600 hover:text-blue-800 p-2 rounded-md bg-blue-50 hover:bg-blue-100 w-full text-center"
//             >
//               {value?.file ? 'File Selected' : 'Change Image'}
//             </label>
//           </div>
//         )
//       }}
//     />
//   );
// };


// // --- Hero Variant Editor Modal ---
// const VariantEditorModal = ({ variant, onClose, onSave, allIcons }) => {
//   const { user } = useAuth();
//   const { register, handleSubmit, control, watch, reset, formState: { errors, isSubmitting } } = useForm();

//   // This effect correctly sets the form's default values when the modal opens or variant changes
//   useEffect(() => {
//      reset(variant ? {
//       ...variant,
//       // Ensure nested fields are populated correctly
//       hero_variant1_icons: (variant.hero_variant1_icons || []).map(icon => ({
//         ...icon,
//         // --- FIX: Stringify JSON for the input ---
//         position: JSON.stringify(icon.position) 
//       })),
//       hero_variant2_photos: (variant.hero_variant2_photos || []).map(p => ({
//         ...p,
//         file: null,
//         originalMediaId: p.media_assets?.id || null,
//         media_id: p.media_assets?.id || null // Pass the media_id
//       })),
//     } : {
//       // Defaults for a new variant
//       title: '',
//       subtitle: '',
//       paragraph: '',
//       variant_type: 'variant1',
//       is_active: true,
//       hero_variant1_icons: [],
//       hero_variant2_photos: [],
//     });
//   }, [variant, reset]);

//   const selectedVariantType = watch('variant_type');

//   const { fields: iconFields, append: appendIcon, remove: removeIcon } = useFieldArray({
//     control,
//     name: 'hero_variant1_icons',
//   });

//   const { fields: photoFields, append: appendPhoto, remove: removePhoto } = useFieldArray({
//     control,
//     name: 'hero_variant2_photos',
//   });

//   const onSubmit = async (data) => {
//     const toastId = toast.loading(variant?.id ? 'Updating variant...' : 'Creating variant...');
    
//     // We pass the *entire* form data and user ID to the API function

//     const { success, error } = await saveHeroVariant(data, '01e31b35-ed86-423b-abd5-01e97bbba857');
    
//     toast.dismiss(toastId);
//     if (success) {
//       toast.success('Variant saved successfully!');
//       onSave(); // This will trigger a refetch in the parent
//       onClose(); // Close the modal
//     } else {
//       toast.error(`Error: ${error}`);
//     }
//   };

//   return (
//     <motion.div
//       initial={{ opacity: 0 }}
//       animate={{ opacity: 1 }}
//       exit={{ opacity: 0 }}
//       className="fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4"
//       onClick={onClose}
//     >
//       <motion.div
//         initial={{ y: 50, scale: 0.95 }}
//         animate={{ y: 0, scale: 1 }}
//         exit={{ y: 50, scale: 0.95 }}
//         className="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col"
//         onClick={e => e.stopPropagation()}
//       >
//         <div className="flex justify-between items-center p-6 border-b">
//           <h2 className="text-2xl font-bold text-gray-900">
//             {variant?.id ? 'Edit Hero Variant' : 'Create New Hero Variant'}
//           </h2>
//           <button onClick={onClose} className="text-gray-400 hover:text-gray-700 p-2">&times;</button>
//         </div>

//         <form onSubmit={handleSubmit(onSubmit)} className="flex-1 overflow-y-auto p-6 space-y-6">
//           <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
//             <FormInput label="Title" name="title" register={register} errors={errors} />
//             <FormInput label="Subtitle" name="subtitle" register={register} errors={errors} />
//           </div>
//           <FormTextarea label="Paragraph" name="paragraph" register={register} errors={errors} />
          
//           <div className="grid grid-cols-1 md:grid-cols-2 gap-4 items-center">
//             <Controller
//               name="variant_type"
//               control={control}
//               render={({ field }) => (
//                 <div className="flex flex-col">
//                   <label className="mb-2 text-sm font-medium text-gray-700">Variant Type</label>
//                   <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
//                     <option value="variant1">Variant 1 (Icons)</option>
//                     <option value="variant2">Variant 2 (Photos)</option>
//                   </select>
//                 </div>
//               )}
//             />
//             <FormToggle label="Is Active?" name="is_active" control={control} />
//           </div>

//           {/* --- Conditional Fields --- */}
//           <AnimatePresence mode="wait">
//             {selectedVariantType === 'variant1' ? (
//               <motion.div
//                 key="variant1"
//                 initial={{ opacity: 0, y: 10 }}
//                 animate={{ opacity: 1, y: 0 }}
//                 exit={{ opacity: 0, y: -10 }}
//                 className="p-4 border border-gray-200 rounded-lg space-y-4"
//               >
//                 <h3 className="font-semibold text-gray-800">Variant 1: Icons</h3>
//                 {iconFields.map((field, index) => (
//                   <div key={field.id} className="grid grid-cols-1 md:grid-cols-3 gap-2 p-2 border-b items-end">
//                     <Controller
//                       name={`hero_variant1_icons.${index}.icon_name`}
//                       control={control}
//                       render={({ field }) => (
//                         <div className="flex flex-col">
//                            <label className="mb-2 text-sm font-medium text-gray-700">Icon</label>
//                           <select {...field} className="p-2 border rounded-md bg-white focus:ring-blue-500 focus:border-blue-500">
//                             <option value="">Select Icon</option>
//                             {/* This should now work correctly */}
//                             {allIcons.map(iconName => <option key={iconName} value={iconName}>{iconName}</option>)}
//                           </select>
//                         </div>
//                       )}
//                     />
                    
//                     {/* --- FIX for [object Object] --- */}
//                     {/* We use a simple FormInput, the logic is in useEffect and saveHeroVariant */}
//                     <FormInput
//                       label="Position (JSON)"
//                       name={`hero_variant1_icons.${index}.position`}
//                       register={register}
//                       errors={errors}
//                       placeholder='{"top": "10%"}'
//                     />

//                     <button type="button" onClick={() => removeIcon(index)} className="text-red-500 hover:text-red-700 p-2">
//                       <Trash2 className="w-5 h-5" />
//                     </button>
//                   </div>
//                 ))}
//                 <button type="button" onClick={() => appendIcon({ icon_name: '', position: '{"top": "0", "left": "0"}' })} className="text-sm font-medium text-blue-600 hover:text-blue-800">
//                   <Plus className="w-4 h-4 inline mr-1" /> Add Icon
//                 </button>
//               </motion.div>
//             ) : (
//               <motion.div
//                 key="variant2"
//                 initial={{ opacity: 0, y: 10 }}
//                 animate={{ opacity: 1, y: 0 }}
//                 exit={{ opacity: 0, y: -10 }}
//                 className="p-4 border border-gray-200 rounded-lg space-y-4"
//               >
//                 <h3 className="font-semibold text-gray-800">Variant 2: Photos</h3>
//                 <div className="grid grid-cols-2 sm:grid-cols-4 gap-4">
//                   {photoFields.map((field, index) => (
//                     <div key={field.id} className="space-y-2 p-2 border rounded-md relative">
//                       <ImageUpload
//                         name={`hero_variant2_photos.${index}`}
//                         control={control}
//                         defaultValue={field.media_assets} // Pass the full media_assets object
//                       />
//                       <FormInput
//                         label="Rotation"
//                         name={`hero_variant2_photos.${index}.rotation`}
//                         register={register}
//                         errors={errors}
//                         type="number"
//                       />
//                       <FormInput
//                         label="Delay (s)"
//                         name={`hero_variant2_photos.${index}.delay`}
//                         register={register}
//                         errors={errors}
//                         type="number"
//                         step="0.1"
//                       />
//                       <button
//                         type="button"
//                         onClick={() => removePhoto(index)}
//                         className="absolute -top-2 -right-2 bg-red-500 text-white p-1 rounded-full shadow"
//                       >
//                         <Trash2 className="w-4 h-4" />
//                       </button>
//                     </div>
//                   ))}
//                   <button
//                     type="button"
//                     onClick={() => appendPhoto({ media_id: null, rotation: 0, delay: 0, file: null, originalMediaId: null })}
//                     className="flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-lg p-4 text-gray-500 hover:border-blue-500 hover:text-blue-500 h-full"
//                   >
//                     <UploadCloud className="w-8 h-8" />
//                     <span className="text-sm mt-2">Add Photo</span>
//                   </button>
//                 </div>
//               </motion.div>
//             )}
//           </AnimatePresence>
//         </form>

//         <div className="flex justify-end items-center p-6 border-t gap-4">
//           <button onClick={onClose} className="px-4 py-2 rounded-md text-gray-600 hover:bg-gray-100">Cancel</button>
//           <button
//             onClick={handleSubmit(onSubmit)}
//             disabled={isSubmitting}
//             className="flex items-center justify-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-blue-700 transition disabled:opacity-50"
//           >
//             {isSubmitting ? <Loader2 className="w-5 h-5 animate-spin" /> : <Save className="w-5 h-5" />}
//             {isSubmitting ? 'Saving...' : 'Save Changes'}
//           </button>
//         </div>
//       </motion.div>
//     </motion.div>
//   );
// };

// // --- Main Editor Component ---
// const AdminHeroEditor = () => {
//   const [variants, setVariants] = useState([]);
//   const [isLoading, setIsLoading] = useState(true);
//   const [isSavingOrder, setIsSavingOrder] = useState(false);
//   const [isModalOpen, setIsModalOpen] = useState(false);
//   const [selectedVariant, setSelectedVariant] = useState(null);

//   // Get all icon names from our IconMap for the dropdown
//   // FIX: Ensure Icon is imported and Object.keys is used
//   const allIconNames = Object.keys(Icon);

//   // Fetch and subscribe to data
//   const loadData = useCallback(async () => {
//     setIsLoading(true);
//     const data = await getHeroVariantsAdmin();
//     setVariants(data);
//     setIsLoading(false);
//   }, []);

//   useEffect(() => {
//     loadData();
//     const subscription = subscribeToHeroChanges(loadData);
//     return () => subscription.unsubscribe();
//   }, [loadData]);

//   // --- Handlers ---
//   const handleReorder = async (newOrder) => {
//     setVariants(newOrder); // Update UI immediately
//     setIsSavingOrder(true);
//     await updateHeroVariantsOrder(newOrder);
//     setIsSavingOrder(false);
//     toast.success('Hero order updated!');
//   };
  
//   const handleToggleActive = async (variant) => {
//     const toastId = toast.loading(variant.is_active ? 'Deactivating...' : 'Activating...');
//     // We just call saveHeroVariant with the *only* change
//     // We need the user for the upload logic, but it's not used here
//     await saveHeroVariant({ ...variant, is_active: !variant.is_active }, null); 
//     toast.dismiss(toastId);
//     toast.success('Visibility updated!');
//     // Real-time listener will handle the UI update
//   };
  
//   const handleDelete = async (variant) => {
//     if (window.confirm(`Are you sure you want to delete the variant "${variant.title || 'Untitled'}"? This cannot be undone.`)) {
//       const toastId = toast.loading('Deleting variant...');
//       const { success, error } = await deleteHeroVariant(variant);
//       toast.dismiss(toastId);
//       if (success) {
//         toast.success('Variant deleted.');
//       } else {
//         toast.error(`Error: ${error}`);
//       }
//       // Real-time listener will handle the UI update
//     }
//   };

//   const openModalToEdit = (variant) => {
//     // Deep copy the variant to prevent mutation of the list state
//     setSelectedVariant(JSON.parse(JSON.stringify(variant)));
//     setIsModalOpen(true);
//   };

//   const openModalToCreate = () => {
//     setSelectedVariant(null); // 'null' signifies "create mode"
//     setIsModalOpen(true);
//   };
  
//   return (
//     <motion.div
//       initial={{ opacity: 0, y: 20 }}
//       animate={{ opacity: 1, y: 0 }}
//       className="space-y-6"
//     >
//       <Toaster position="bottom-center" />

//       {/* Header */}
//       <div className="flex flex-col sm:flex-row justify-between sm:items-center gap-4">
//         <div>
//           <Link to="/admin/homepage-config" className="flex items-center gap-2 text-sm text-gray-500 hover:text-gray-900 mb-2">
//             <ArrowLeft className="w-4 h-4" /> Back to Homepage Manager
//           </Link>
//           <h1 className="text-3xl font-bold text-gray-900">Edit Hero Section</h1>
//         </div>
//         <button
//           onClick={openModalToCreate}
//           className="flex items-center justify-center gap-2 bg-green-600 text-white px-6 py-3 rounded-lg font-medium shadow-md hover:bg-green-700 transition"
//         >
//           <Plus className="w-5 h-5" /> Create New Variant
//         </button>
//       </div>

//       {/* Editor Content Area */}
//       <div className="bg-white p-8 rounded-lg shadow border border-gray-200">
//         <h2 className="text-xl font-semibold text-gray-800">Manage Hero Variants</h2>
//         <p className="text-gray-500 mt-2 mb-6">
//           Drag and drop variants to reorder them. You can have multiple active variants to create a carousel.
//         </p>
        
//         {isLoading ? (
//           <div className="flex items-center justify-center h-48"><Loader2 className="w-8 h-8 animate-spin text-blue-600" /></div>
//         ) : (
//           <Reorder.Group axis="y" values={variants} onReorder={handleReorder} className="space-y-4">
//             {variants.map(variant => (
//               <Reorder.Item key={variant.id} value={variant} className="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 flex items-center gap-4">
//                 <GripVertical className="text-gray-400 cursor-grab" />
//                 <div className="flex-1">
//                   <h3 className="font-semibold text-gray-900">{variant.title || 'Untitled'}</h3>
//                   <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${variant.variant_type === 'variant1' ? 'bg-blue-100 text-blue-800' : 'bg-purple-100 text-purple-800'}`}>
//                     {variant.variant_type === 'variant1' ? 'Type 1: Icons' : 'Type 2: Photos'}
//                   </span>
//                 </div>
//                 <div className="flex items-center gap-4">
//                   <button onClick={() => handleToggleActive(variant)} title={variant.is_active ? 'Deactivate' : 'Activate'}>
//                     {variant.is_active ? <Eye className="w-5 h-5 text-green-500" /> : <EyeOff className="w-5 h-5 text-gray-400" />}
//                   </button>
//                   <button onClick={() => openModalToEdit(variant)} className="text-sm font-medium text-blue-600 hover:text-blue-800">Edit</button>
//                   <button onClick={() => handleDelete(variant)} className="text-sm font-medium text-red-600 hover:text-red-800">Delete</button>
//                 </div>
//               </Reorder.Item>
//             ))}
//           </Reorder.Group>
//         )}
//         {isSavingOrder && <p className="text-sm text-gray-500 mt-4 flex items-center gap-2"><Loader2 className="animate-spin" /> Saving new order...</p>}
//       </div>
      
//       {/* --- Editor Modal --- */}
//       <AnimatePresence>
//         {isModalOpen && (
//           <VariantEditorModal
//             variant={selectedVariant}
//             onClose={() => setIsModalOpen(false)}
//             onSave={loadData} // Refetch data on save
//             allIcons={allIconNames}
//           />
//         )}
//       </AnimatePresence>
//     </motion.div>
//   );
// };

// export default AdminHeroEditor;
// import React, { useState } from 'react';
// import { motion, AnimatePresence, wrap } from 'framer-motion';
// import { fetchTestimonials } from '../../api/homepage';
// import { useHomepageData, getStorageUrl } from '../../hooks/useHomepageData';
// import { Icon } from '../common/IconMap';
// import { Loader2 } from 'lucide-react';

// const Testimonials = () => {
//   const { data: testimonials, loading } = useHomepageData(
//     fetchTestimonials, 
//     'testimonials', 
//     { additionalTables: ['media_assets'] }
//   );
//   const [[page, direction], setPage] = useState([0, 0]);

//   if (loading || !testimonials) {
//     return <section className="py-24 bg-white"><Loader2 className="animate-spin" /></section>;
//   }

//   const i = wrap(0, testimonials.length, page);
//   const testimonial = testimonials[i];
//   if (!testimonial) return null;

//   const paginate = (newDirection) => {
//     setPage([page + newDirection, newDirection]);
//   };

//   const slideVariants = {
//     enter: (direction) => ({
//       x: direction > 0 ? '100%' : '-100%',
//       opacity: 0,
//     }),
//     center: {
//       zIndex: 1,
//       x: 0,
//       opacity: 1,
//     },
//     exit: (direction) => ({
//       zIndex: 0,
//       x: direction < 0 ? '100%' : '-100%',
//       opacity: 0,
//     }),
//   };

//   const avatarUrl = getStorageUrl(testimonial.media_assets);

//   return (
//     <section className="py-24 bg-white">
//       <div className="container mx-auto px-4 max-w-4xl text-center">
//         <h2 className="text-4xl md:text-5xl font-extrabold text-gray-900 mb-12">
//           What my clients say
//         </h2>
//         <div className="relative h-[350px] md:h-[300px] overflow-hidden">
//           <AnimatePresence initial={false} custom={direction} mode="wait">
//             <motion.div
//               key={page}
//               custom={direction}
//               variants={slideVariants}
//               initial="enter"
//               animate="center"
//               exit="exit"
//               transition={{
//                 x: { type: 'spring', stiffness: 300, damping: 30 },
//                 opacity: { duration: 0.2 },
//               }}
//               className="absolute w-full flex flex-col items-center"
//             >
//               {avatarUrl && (
//                 <img
//                   src={avatarUrl}
//                   alt={testimonial.name}
//                   className="w-20 h-20 rounded-full mb-6"
//                 />
//               )}
//               <div className="flex mb-4">
//                 {[...Array(5)].map((_, i) => (
//                   <Icon key={i} name="Star" className="w-5 h-5 text-yellow-400 fill-current" />
//                 ))}
//               </div>
//               <p className="text-2xl font-medium text-gray-800 italic mb-6">
//                 "{testimonial.quote}"
//               </p>
//               <div className="font-bold text-gray-900">
//                 {testimonial.name}
//                 <span className="font-normal text-gray-500 ml-2">
//                   | {testimonial.role}
//                 </span>
//               </div>
//             </motion.div>
//           </AnimatePresence>
//         </div>
        
//         {/* Controls */}
//         <button
//           className="absolute left-4 md:left-16 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-100"
//           onClick={() => paginate(-1)}
//         >
//           <Icon name="ChevronLeft" size={24} />
//         </button>
//         <button
//           className="absolute right-4 md:right-16 top-1/2 -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-100"
//           onClick={() => paginate(1)}
//         >
//           <Icon name="ChevronRight" size={24} />
//         </button>
//       </div>
//     </section>
//   );
// };

// export default Testimonials;
// // About.jsx
// // (This file would be added to your router, e.g., path: '/about')

// import React, { useRef } from 'react';
// import { motion, useScroll, useTransform, useInView } from 'framer-motion';
// import { Link } from 'react-router-dom';
// import { 
//   ArrowRight, 
//   Lightbulb, 
//   Check, 
//   Heart, 
//   TrendingUp,
//   LayoutGrid,
//   Palette,
//   Zap,
//   Box,
//   Monitor,
//   Camera
// } from 'lucide-react';

// // Reusable component for animating text words on scroll
// const AnimatedTextWord = ({ text, el: El = 'p', className, ...props }) => {
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.2 });
//   const wordVariants = {
//     hidden: { opacity: 0, y: 10, filter: 'blur(2px)' },
//     visible: (i) => ({
//       opacity: 1,
//       y: 0,
//       filter: 'blur(0px)',
//       transition: { delay: i * 0.02, type: 'spring', stiffness: 100, damping: 10 }
//     })
//   };
//   return (
//     <El ref={ref} className={className} {...props}>
//       <motion.span initial="hidden" animate={isInView ? "visible" : "hidden"}>
//         {text.split(' ').map((word, i) => (
//           <motion.span key={i} variants={wordVariants} custom={i} className="inline-block mr-1.5">
//             {word}
//           </motion.span>
//         ))}
//       </motion.span>
//     </El>
//   );
// };

// // --- Hero Section ---
// const AboutHero = () => {
//   return (
//     <div className="grid grid-cols-1 lg:grid-cols-2 items-center min-h-[80vh] container mx-auto px-4 sm:px-6 lg:px-8">
//       {/* Left Side: Text */}
//       <div className="text-center lg:text-left">
//         <motion.p
//           className="text-lg font-medium text-blue-600 mb-2"
//           initial={{ opacity: 0, x: -50 }}
//           animate={{ opacity: 1, x: 0 }}
//           transition={{ duration: 0.7, delay: 0.2 }}
//         >
//           Gaddam Bharath Kumar
//         </motion.p>
//         <div className="overflow-hidden">
//           <motion.h1
//             className="text-5xl md:text-7xl font-bold tracking-tighter text-gray-900"
//             initial={{ clipPath: 'polygon(0 100%, 100% 100%, 100% 100%, 0 100%)' }}
//             animate={{ clipPath: 'polygon(0 0%, 100% 0%, 100% 100%, 0 100%)' }}
//             transition={{ duration: 1, delay: 0.5, ease: [0.4, 0, 0.2, 1] }}
//           >
//             Designer, Thinker,
//             <br />
//             Problem Solver.
//           </motion.h1>
//         </div>
//         <AnimatedTextWord 
//           el="p"
//           text="I am a multi-disciplinary graphic designer with a passion for building beautiful, functional, and user-centric experiences. I bridge the gap between aesthetics and purpose."
//           className="text-lg text-gray-600 leading-relaxed mt-6 max-w-lg mx-auto lg:mx-0"
//         />
//       </div>
      
//       {/* Right Side: Image */}
//       <motion.div
//         className="relative mt-12 lg:mt-0"
//         initial={{ opacity: 0, scale: 0.8 }}
//         animate={{ opacity: 1, scale: 1 }}
//         transition={{ duration: 0.7, delay: 0.4, type: 'spring' }}
//       >
//         <motion.img
//           src="https://placehold.co/600x600/DBEAFE/1E40AF?text=G.B.K."
//           alt="Gaddam Bharath Kumar"
//           className="rounded-full shadow-2xl w-3/4 max-w-md mx-auto"
//           animate={{ y: [0, -20, 0] }}
//           transition={{
//             duration: 5,
//             repeat: Infinity,
//             ease: 'easeInOut',
//           }}
//         />
//       </motion.div>
//     </div>
//   );
// };

// // --- Core Values Section ---
// const CoreValues = () => {
//   const values = [
//     { icon: Lightbulb, title: "Creativity", desc: "Pushing boundaries to deliver unique and original solutions." },
//     { icon: Check, title: "Precision", desc: "Pixel-perfect attention to detail in every single project." },
//     { icon: Heart, title: "Empathy", desc: "Designing for people first, understanding user needs and emotions." },
//     { icon: TrendingUp, title: "Impact", desc: "Creating design that not only looks good but achieves business goals." },
//   ];

//   return (
//     <div className="bg-gray-50 py-24">
//       <div className="container mx-auto px-4 sm:px-6 lg:px-8">
//         <AnimatedTextWord 
//           el="h2"
//           text="My Core Values"
//           className="text-4xl font-bold tracking-tighter text-center mb-16"
//         />
//         <motion.div 
//           className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"
//           initial="hidden"
//           whileInView="visible"
//           viewport={{ once: true, amount: 0.2 }}
//           transition={{ staggerChildren: 0.1 }}
//         >
//           {values.map((val, i) => (
//             <motion.div
//               key={i}
//               className="bg-white p-8 rounded-2xl shadow-lg"
//               variants={{
//                 hidden: { opacity: 0, y: 50 },
//                 visible: { opacity: 1, y: 0, transition: { type: 'spring', stiffness: 100 } }
//               }}
//             >
//               <val.icon className="w-10 h-10 text-blue-600" />
//               <h3 className="text-xl font-semibold text-gray-900 mt-6">{val.title}</h3>
//               <p className="text-gray-600 mt-2">{val.desc}</p>
//             </motion.div>
//           ))}
//         </motion.div>
//       </div>
//     </div>
//   );
// };

// // --- Animated Journey (Timeline) Section ---
// const MyJourney = () => {
//   const ref = useRef(null);
//   const { scrollYProgress } = useScroll({
//     target: ref,
//     offset: ['start end', 'end start']
//   });
  
//   // This animates the vertical line "drawing" itself
//   const lineHeight = useTransform(scrollYProgress, [0, 0.8], ['0%', '100%']);

//   const items = [
//     { year: '2018', title: 'Started My Design Journey', desc: 'Began exploring graphic design, mastering the fundamentals of Adobe Creative Suite.' },
//     { year: '2020', title: 'B.Sc. in Design', desc: 'Graduated from [Your University Name], specializing in Visual Communication.' },
//     { year: '2021', title: 'First Agency Role', desc: 'Joined a fast-paced agency as a Junior Designer, working on national campaigns.' },
//     { year: '2023', title: 'Went Freelance', desc: 'Started my freelance career to partner directly with clients and build impactful brands.' },
//     { year: 'Present', title: 'Always Learning', desc: 'Exploring 3D motion and AR filters to push the boundaries of design.' },
//   ];

//   return (
//     <div ref={ref} className="py-24 bg-white relative">
//       <div className="container mx-auto px-4 sm:px-6 lg:px-8">
//         <AnimatedTextWord 
//           el="h2"
//           text="My Journey"
//           className="text-4xl font-bold tracking-tighter text-center mb-16"
//         />
        
//         {/* The connecting line */}
//         <div className="absolute left-4 md:left-1/2 -translate-x-1/2 h-full top-0">
//           <div className="w-1 bg-gray-200 h-full" />
//           <motion.div 
//             className="w-1 bg-blue-600 absolute top-0"
//             style={{ height: lineHeight }}
//           />
//         </div>

//         <div className="space-y-16">
//           {items.map((item, i) => (
//             <JourneyItem key={i} item={item} />
//           ))}
//         </div>
//       </div>
//     </div>
//   );
// };

// // --- Timeline Item ---
// const JourneyItem = ({ item }) => {
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.5 });
  
//   const variants = {
//     hidden: { opacity: 0, x: 50 },
//     visible: { opacity: 1, x: 0, transition: { type: 'spring', stiffness: 100, delay: 0.2 } }
//   };

//   return (
//     <div ref={ref} className="flex md:justify-center">
//       <div className="flex w-full max-w-4xl relative">
//         {/* Dot on timeline */}
//         <motion.div
//           className="w-4 h-4 bg-blue-600 rounded-full absolute left-[10px] md:left-1/2 -translate-x-1/2 mt-3"
//           initial={{ scale: 0 }}
//           animate={isInView ? { scale: 1.5 } : {}}
//           transition={{ type: 'spring', stiffness: 300, delay: 0.3 }}
//         >
//           <motion.div 
//             className="w-full h-full bg-blue-600 rounded-full"
//             animate={isInView ? { scale: 0.5 } : {}}
//             transition={{ type: 'spring', stiffness: 300, delay: 0.5 }}
//           />
//         </motion.div>
        
//         {/* Content Box */}
//         <motion.div 
//           className="w-full ml-10 md:ml-0 md:w-1/2 md:pr-12"
//           variants={variants}
//           initial="hidden"
//           animate={isInView ? "visible" : "hidden"}
//         >
//           <p className="text-xl font-bold text-blue-600">{item.year}</p>
//           <h3 className="text-2xl font-semibold text-gray-900 mt-1">{item.title}</h3>
//           <p className="text-gray-600 mt-2">{item.desc}</p>
//         </motion.div>
//         {/* Empty space for alignment */}
//         <div className="hidden md:block md:w-1/2" />
//       </div>
//     </div>
//   );
// };


// // --- Skills Bento Grid Section ---
// const SkillsBento = () => {
//   const skills = [
//     { title: "Brand Identity", icon: Palette, className: "col-span-2 row-span-2 bg-blue-100 text-blue-800" },
//     { title: "UI/UX Design", icon: Monitor, className: "col-span-1 row-span-1 bg-green-100 text-green-800" },
//     { title: "Motion Graphics", icon: Zap, className: "col-span-1 row-span-1 bg-purple-100 text-purple-800" },
//     { title: "Packaging", icon: Box, className: "col-span-1 row-span-1 bg-yellow-100 text-yellow-800" },
//     { title: "3D & VFX", icon: Camera, className: "col-span-1 row-span-1 bg-red-100 text-red-800" },
//     { title: "Web Design", icon: LayoutGrid, className: "col-span-2 row-span-1 bg-indigo-100 text-indigo-800" },
//   ];
  
//   return (
//     <div className="py-24 bg-gray-900">
//       <div className="container mx-auto px-4 sm:px-6 lg:px-8">
//         <AnimatedTextWord 
//           el="h2"
//           text="My Expertise"
//           className="text-4xl font-bold tracking-tighter text-center text-white mb-16"
//         />
//         <motion.div
//           className="grid grid-cols-2 md:grid-cols-3 grid-rows-3 gap-6 h-[700px] md:h-[600px]"
//           initial="hidden"
//           whileInView="visible"
//           viewport={{ once: true, amount: 0.1 }}
//           transition={{ staggerChildren: 0.1 }}
//         >
//           {skills.map((skill) => (
//             <motion.div
//               key={skill.title}
//               className={`p-8 rounded-2xl shadow-lg flex flex-col justify-between ${skill.className}`}
//               variants={{
//                 hidden: { opacity: 0, y: 30, scale: 0.95 },
//                 visible: { opacity: 1, y: 0, scale: 1, transition: { type: 'spring', stiffness: 100 } }
//               }}
//               whileHover={{ scale: 1.03, y: -5 }}
//             >
//               <skill.icon className="w-10 h-10" />
//               <h3 className="text-2xl font-bold mt-4">{skill.title}</h3>
//             </motion.div>
//           ))}
//         </motion.div>
//       </div>
//     </div>
//   );
// };

// // --- Page CTA Section ---
// const PageCTA = () => (
//   <div className="py-24 bg-white">
//     <div className="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
//       <motion.div
//         initial="hidden"
//         whileInView="visible"
//         viewport={{ once: true, amount: 0.5 }}
//         variants={{
//           hidden: { opacity: 0, y: 30 },
//           visible: { opacity: 1, y: 0, transition: { type: 'spring' } }
//         }}
//       >
//         <h2 className="text-4xl font-bold tracking-tighter text-gray-900">
//           See my work in action.
//         </h2>
//         <p className="text-lg text-gray-600 mt-4 max-w-xl mx-auto">
//           Words are one thing, but results are another. See how I've
//           applied my skills to real-world projects.
//         </p>
//         <motion.div
//           className="mt-10"
//           whileHover={{ scale: 1.05 }}
//           whileTap={{ scale: 0.95 }}
//         >
//           <Link
//             to="/projects"
//             className="inline-flex items-center bg-blue-600 text-white px-8 py-3.5 rounded-lg text-lg font-medium shadow-lg hover:bg-blue-700"
//           >
//             View All Projects <ArrowRight className="w-5 h-5 ml-2" />
//           </Link>
//         </motion.div>
//       </motion.div>
//     </div>
//   </div>
// );


// // --- Main About Page Component ---
// export default function About() {
//   return (
//     <div className="pt-16">
//       <AboutHero />
//       <CoreValues />
//       <MyJourney />
//       <SkillsBento />
//       <PageCTA />
//     </div>
//   );
// }




// import React, { useState, useRef, useEffect } from 'react';
// import { motion, AnimatePresence, useInView } from 'framer-motion';
// import { 
//   ArrowRight, 
//   Search, 
//   LayoutGrid, 
//   Palette, 
//   Zap,
//   Package,
//   Printer,
//   Monitor,
//   List
// } from 'lucide-react';
// import { Link } from 'react-router-dom';

// // --- EXPANDED PROJECT DATA ---
// const allProjects = [
//   {
//     id: 'zenith-motion',
//     title: 'Zenith',
//     category: 'Motion Graphics',
//     description: 'Animated brand identity for a cutting-edge tech startup.',
//     heroImage: 'https://placehold.co/800x800/1F2937/9CA3AF?text=Zenith',
//   },
//   {
//     id: 'oasis-skincare',
//     title: 'Oasis',
//     category: 'Packaging',
//     description: 'Earthy and minimal packaging design for an organic skincare line.',
//     heroImage: 'https://placehold.co/800x800/F0FDF4/166534?text=Oasis',
//   },
//   {
//     id: 'quantum-poster',
//     title: 'Quantum',
//     category: 'Print Design',
//     description: 'A series of futuristic event posters for a science exhibition.',
//     heroImage: 'https://placehold.co/800x800/F3E8FF/581C87?text=Quantum',
//   },
//   {
//     id: 'nova-app-ui',
//     title: 'Nova UI',
//     category: 'UI/UX',
//     description: 'A clean and intuitive mobile banking application.',
//     heroImage: 'https://placehold.co/800x800/DBEAFE/1E40AF?text=Nova+UI',
//   },
//   {
//     id: 'apex-branding',
//     title: 'Apex',
//     category: 'Brand Identity',
//     description: 'A bold and geometric brand identity for a sports apparel company.',
//     heroImage: 'https://placehold.co/800x800/FEF2F2/991B1B?text=Apex',
//   },
//   {
//     id: 'helios-website',
//     title: 'Helios',
//     category: 'Web Design',
//     description: 'A vibrant and engaging website for a solar energy provider.',
//     heroImage: 'https://placehold.co/800x800/FEF9C3/713F12?text=Helios',
//   },
//   {
//     id: 'arc-ai',
//     title: 'Arc AI',
//     category: 'Brand Identity',
//     description: 'A futuristic and fluid logo mark for an AI-powered analytics firm.',
//     heroImage: 'https://placehold.co/800x800/1E3A8A/93C5FD?text=Arc+AI',
//   },
//   {
//     id: 'nomad-app',
//     title: 'Nomad',
//     category: 'UI/UX',
//     description: 'A social travel planning app for digital nomads and adventurers.',
//     heroImage: 'https://placehold.co/800x800/312E81/A5B4FC?text=Nomad',
//   },
//   {
//     id: 'origin-coffee',
//     title: 'Origin',
//     category: 'Packaging',
//     description: 'Sustainable and premium coffee packaging with bold typography.',
//     heroImage: 'https://placehold.co/800x800/7C2D12/FDBA74?text=Origin',
//   },
//   {
//     id: 'voxel-labs',
//     title: 'Voxel',
//     category: 'Motion Graphics',
//     description: 'A 3D motion ident for a next-gen gaming studio.',
//     heroImage: 'https://placehold.co/800x800/365314/BEF264?text=Voxel',
//   },
//   {
//     id: 'cygnus-web',
//     title: 'Cygnus',
//     category: 'Web Design',
//     description: 'An immersive, scroll-based website for a space exploration documentary.',
//     heroImage: 'https://placehold.co/800x800/064E3B/6EE7B7?text=Cygnus',
//   },
//   {
//     id: 'muse-mag',
//     title: 'Muse',
//     category: 'Print Design',
//     description: 'Editorial layout and cover design for an independent arts magazine.',
//     heroImage: 'https://placehold.co/800x800/831843/F9A8D4?text=Muse',
//   },
// ];

// // --- EXPANDED CATEGORIES ---
// const categories = [
//   { name: 'All', icon: LayoutGrid },
//   { name: 'UI/UX', icon: Monitor },
//   { name: 'Brand Identity', icon: Palette },
//   { name: 'Motion Graphics', icon: Zap },
//   { name: 'Packaging', icon: Package },
//   { name: 'Print Design', icon: Printer },
//   { name: 'Web Design', icon: Monitor }, // Web design also uses Monitor icon
// ];

// // --- Kinetic Text Header (Unchanged) ---
// const KineticHeader = () => {
//   const words = ["Creative", "Works", "Archive", "Projects", "Portfolio"];
//   const [currentWord, setCurrentWord] = useState(words[0]);

//   useEffect(() => {
//     const interval = setInterval(() => {
//       setCurrentWord((prev) => {
//         const nextIndex = (words.indexOf(prev) + 1) % words.length;
//         return words[nextIndex];
//       });
//     }, 1500);
//     return () => clearInterval(interval);
//   }, []);

//   const variants = {
//     enter: { opacity: 0, y: 20, filter: 'blur(5px)' },
//     center: { opacity: 1, y: 0, filter: 'blur(0px)' },
//     exit: { opacity: 0, y: -20, filter: 'blur(5px)' },
//   };

//   return (
//     <div className="flex text-5xl md:text-8xl font-bold tracking-tighter text-gray-900 justify-center">
//       <span className="mr-4">My</span>
//       <AnimatePresence mode="wait">
//         <motion.span
//           key={currentWord}
//           variants={variants}
//           initial="enter"
//           animate="center"
//           exit="exit"
//           transition={{ duration: 0.5, type: 'spring', stiffness: 200, damping: 20 }}
//           className="text-blue-600 block"
//         >
//           {currentWord}
//         </motion.span>
//       </AnimatePresence>
//     </div>
//   );
// };

// // --- Project Card Component (Grid View) ---
// const ProjectCard = ({ project }) => {
//   const [isHovered, setIsHovered] = useState(false);
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.4 });

//   const cardVariants = {
//     hidden: { opacity: 0, y: 50, scale: 0.9 },
//     visible: { 
//       opacity: 1, 
//       y: 0, 
//       scale: 1,
//       transition: { type: 'spring', stiffness: 100, damping: 12 }
//     },
//   };

//   return (
//     <Link to={`/projects/${project.id}`}>
//       <motion.div
//         ref={ref}
//         variants={cardVariants}
//         initial="hidden"
//         animate={isInView ? "visible" : "hidden"}
//         className="relative rounded-2xl overflow-hidden shadow-lg cursor-pointer"
//         onHoverStart={() => setIsHovered(true)}
//         onHoverEnd={() => setIsHovered(false)}
//       >
//         <motion.img
//           src={project.heroImage}
//           alt={project.title}
//           className="w-full h-[400px] object-cover"
//           layoutId={`project-hero-${project.id}`}
//           animate={{ scale: isHovered ? 1.05 : 1 }}
//           transition={{ duration: 0.4, ease: 'easeInOut' }}
//         />
//         <AnimatePresence>
//           {isHovered && (
//             <motion.div
//               className="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent"
//               initial={{ opacity: 0, y: 20 }}
//               animate={{ opacity: 1, y: 0 }}
//               exit={{ opacity: 0, y: 20 }}
//               transition={{ duration: 0.3 }}
//             >
//               <motion.h3 
//                 className="text-2xl font-bold text-white"
//                 layoutId={`project-title-${project.id}`}
//               >
//                 {project.title}
//               </motion.h3>
//               <p className="text-blue-300">{project.category}</p>
//             </motion.div>
//           )}
//         </AnimatePresence>
//       </motion.div>
//     </Link>
//   );
// };

// // --- *** NEW *** Project List Row Component (List View) ---
// const ProjectListRow = ({ project }) => {
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.4 });

//   const rowVariants = {
//     hidden: { opacity: 0, x: -50 },
//     visible: { 
//       opacity: 1, 
//       x: 0,
//       transition: { type: 'spring', stiffness: 100, damping: 15 }
//     },
//   };

//   return (
//     <Link to={`/projects/${project.id}`}>
//       <motion.div
//         ref={ref}
//         variants={rowVariants}
//         initial="hidden"
//         animate={isInView ? "visible" : "hidden"}
//         whileHover={{
//           scale: 1.01,
//           boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)' 
//         }}
//         className="flex flex-col md:flex-row items-center bg-white p-4 rounded-2xl shadow-lg cursor-pointer overflow-hidden"
//       >
//         <motion.img
//           src={project.heroImage}
//           alt={project.title}
//           className="w-full md:w-48 h-48 md:h-32 rounded-lg object-cover"
//           layoutId={`project-hero-${project.id}`}
//           transition={{ duration: 0.4, ease: 'easeInOut' }}
//         />
//         <div className="flex-grow p-4">
//           <motion.h3 
//             className="text-2xl font-bold text-gray-900"
//             layoutId={`project-title-${project.id}`}
//           >
//             {project.title}
//           </motion.h3>
//           <p className="text-blue-600 font-medium">{project.category}</p>
//           <p className="text-gray-600 mt-2 hidden md:block">{project.description}</p>
//         </div>
//         <motion.div
//           className="p-4"
//           initial={{ x: -20, opacity: 0 }}
//           animate={{ x: 0, opacity: 1 }}
//           transition={{ delay: 0.2 }}
//         >
//           <ArrowRight className="w-6 h-6 text-gray-400" />
//         </motion.div>
//       </motion.div>
//     </Link>
//   );
// };


// // --- Main Projects Page Component ---
// export default function Projects() {
//   const [filter, setFilter] = useState('All');
//   const [searchQuery, setSearchQuery] = useState('');
//   const [view, setView] = useState('grid'); // 'grid' or 'list'
//   const [visibleCount, setVisibleCount] = useState(6); // For "Load More"

//   // 1. Filter by Category
//   const filteredProjects = allProjects.filter((p) => 
//     filter === 'All' ? true : p.category === filter
//   );

//   // 2. Filter by Search Query
//   const searchedProjects = filteredProjects.filter((p) =>
//     p.title.toLowerCase().includes(searchQuery.toLowerCase())
//   );
  
//   // 3. Paginate
//   const projectsToShow = searchedProjects.slice(0, visibleCount);
  
//   const handleLoadMore = () => {
//     setVisibleCount(prev => prev + 6); // Load 6 more
//   };

//   const containerVariants = {
//     hidden: {},
//     visible: {
//       transition: { staggerChildren: 0.1 }
//     }
//   };

//   return (
//     <div className="bg-gray-50 min-h-screen">
//       <main className="pt-32 pb-24 container mx-auto px-4 sm:px-6 lg:px-8">
//         {/* --- Animated Header --- */}
//         <motion.div 
//           className="text-center mb-12"
//           initial={{ opacity: 0, y: 20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.8, delay: 0.2, ease: 'easeOut' }}
//         >
//           <KineticHeader />
//           <p className="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">
//             A curated selection of my work. Each project is a story of creative
//             problem-solving, passion, and pixel-perfect execution.
//           </p>
//         </motion.div>
        
//         {/* --- *** NEW *** Control Bar (Search, Filter, View) --- */}
//         <motion.div
//           className="sticky top-[72px] z-30 bg-gray-50/80 backdrop-blur-md p-4 mb-8 rounded-2xl shadow"
//           initial={{ opacity: 0, y: -20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.5, delay: 0.4 }}
//         >
//           <div className="flex flex-col md:flex-row gap-4">
//             {/* Search Bar */}
//             <div className="relative flex-grow">
//               <input
//                 type="text"
//                 placeholder="Search projects by title..."
//                 value={searchQuery}
//                 onChange={(e) => setSearchQuery(e.target.value)}
//                 className="w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
//               />
//               <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
//             </div>
//             {/* View Toggle */}
//             <div className="flex-shrink-0 flex bg-gray-200 rounded-lg p-1">
//               {['grid', 'list'].map((viewMode) => (
//                 <motion.button
//                   key={viewMode}
//                   onClick={() => setView(viewMode)}
//                   className={`relative w-1/2 md:w-auto px-4 py-2 rounded-md text-sm font-medium ${
//                     view === viewMode ? 'text-white' : 'text-gray-600'
//                   }`}
//                   whileHover={{ y: -2 }}
//                 >
//                   {view === viewMode && (
//                     <motion.div
//                       className="absolute inset-0 bg-blue-600 rounded-md"
//                       layoutId="view-active"
//                       transition={{ type: 'spring', stiffness: 300, damping: 30 }}
//                     />
//                   )}
//                   <span className="relative z-10 flex items-center justify-center capitalize">
//                     {viewMode === 'grid' ? <LayoutGrid className="w-4 h-4 mr-2" /> : <List className="w-4 h-4 mr-2" />}
//                     {viewMode}
//                   </span>
//                 </motion.button>
//               ))}
//             </div>
//           </div>
//         </motion.div>

//         {/* --- Animated Filter Bar --- */}
//         <motion.div 
//           className="flex flex-wrap justify-center gap-4 mb-16"
//           initial={{ opacity: 0, y: 20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.8, delay: 0.6, ease: 'easeOut' }}
//         >
//           {categories.map((cat) => (
//             <motion.button
//               key={cat.name}
//               onClick={() => {
//                 setFilter(cat.name);
//                 setVisibleCount(6); // Reset pagination on filter change
//               }}
//               className={`relative px-5 py-2.5 rounded-lg text-sm font-medium ${
//                 filter === cat.name ? 'text-white' : 'text-gray-700 bg-white shadow-sm hover:bg-gray-100'
//               }`}
//               whileHover={{ y: -2 }}
//             >
//               {filter === cat.name && (
//                 <motion.div
//                   className="absolute inset-0 bg-blue-600 rounded-lg shadow-md"
//                   layoutId="filter-active"
//                   transition={{ type: 'spring', stiffness: 300, damping: 30 }}
//                 />
//               )}
//               <span className="relative z-10 flex items-center">
//                 <cat.icon className="w-4 h-4 mr-2" /> {cat.name}
//               </span>
//             </motion.button>
//           ))}
//         </motion.div>

//         {/* --- Animated Project Grid / List --- */}
//         <AnimatePresence mode="wait">
//           {view === 'grid' ? (
//             <motion.div
//               key="grid"
//               className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"
//               variants={containerVariants}
//               initial="hidden"
//               animate="visible"
//               exit={{ opacity: 0, y: 20 }}
//             >
//               <AnimatePresence>
//                 {projectsToShow.map((project) => (
//                   <ProjectCard key={project.id} project={project} />
//                 ))}
//               </AnimatePresence>
//             </motion.div>
//           ) : (
//             <motion.div
//               key="list"
//               className="space-y-6"
//               variants={containerVariants}
//               initial="hidden"
//               animate="visible"
//               exit={{ opacity: 0, y: 20 }}
//             >
//               <AnimatePresence>
//                 {projectsToShow.map((project) => (
//                   <ProjectListRow key={project.id} project={project} />
//                 ))}
//               </AnimatePresence>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//         {/* --- *** NEW *** "Load More" Button --- */}
//         <AnimatePresence>
//           {visibleCount < searchedProjects.length && (
//             <motion.div
//               className="flex justify-center mt-16"
//               initial={{ opacity: 0, y: 50 }}
//               animate={{ opacity: 1, y: 0 }}
//               exit={{ opacity: 0, y: 50 }}
//             >
//               <motion.button
//                 onClick={handleLoadMore}
//                 className="bg-blue-600 text-white px-8 py-3.5 rounded-lg text-lg font-medium shadow-lg"
//                 whileHover={{ scale: 1.05, y: -2 }}
//                 whileTap={{ scale: 0.95 }}
//               >
//                 Load More Projects
//               </motion.button>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//         {/* No Results Message */}
//         <AnimatePresence>
//           {searchedProjects.length === 0 && (
//             <motion.div
//               className="text-center mt-16"
//               initial={{ opacity: 0, y: 20 }}
//               animate={{ opacity: 1, y: 0 }}
//             >
//               <h3 className="text-2xl font-bold text-gray-900">No Projects Found</h3>
//               <p className="text-gray-600 mt-2">
//                 Try adjusting your search or filter.
//               </p>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//       </main>
//     </div>
//   );
// }



// import React, { useState, useRef, useEffect } from 'react';
// import { motion, AnimatePresence, useInView } from 'framer-motion';
// import { 
//   ArrowRight, 
//   Search, 
//   LayoutGrid, 
//   Palette, 
//   Zap,
//   Package,
//   Printer,
//   Monitor,
//   List
// } from 'lucide-react';
// import { Link } from 'react-router-dom';

// // --- EXPANDED PROJECT DATA ---
// const allProjects = [
//   {
//     id: 'zenith-motion',
//     title: 'Zenith',
//     category: 'Motion Graphics',
//     description: 'Animated brand identity for a cutting-edge tech startup.',
//     heroImage: 'https://placehold.co/800x800/1F2937/9CA3AF?text=Zenith',
//   },
//   {
//     id: 'oasis-skincare',
//     title: 'Oasis',
//     category: 'Packaging',
//     description: 'Earthy and minimal packaging design for an organic skincare line.',
//     heroImage: 'https://placehold.co/800x800/F0FDF4/166534?text=Oasis',
//   },
//   {
//     id: 'quantum-poster',
//     title: 'Quantum',
//     category: 'Print Design',
//     description: 'A series of futuristic event posters for a science exhibition.',
//     heroImage: 'https://placehold.co/800x800/F3E8FF/581C87?text=Quantum',
//   },
//   {
//     id: 'nova-app-ui',
//     title: 'Nova UI',
//     category: 'UI/UX',
//     description: 'A clean and intuitive mobile banking application.',
//     heroImage: 'https://placehold.co/800x800/DBEAFE/1E40AF?text=Nova+UI',
//   },
//   {
//     id: 'apex-branding',
//     title: 'Apex',
//     category: 'Brand Identity',
//     description: 'A bold and geometric brand identity for a sports apparel company.',
//     heroImage: 'https://placehold.co/800x800/FEF2F2/991B1B?text=Apex',
//   },
//   {
//     id: 'helios-website',
//     title: 'Helios',
//     category: 'Web Design',
//     description: 'A vibrant and engaging website for a solar energy provider.',
//     heroImage: 'https://placehold.co/800x800/FEF9C3/713F12?text=Helios',
//   },
//   {
//     id: 'arc-ai',
//     title: 'Arc AI',
//     category: 'Brand Identity',
//     description: 'A futuristic and fluid logo mark for an AI-powered analytics firm.',
//     heroImage: 'https://placehold.co/800x800/1E3A8A/93C5FD?text=Arc+AI',
//   },
//   {
//     id: 'nomad-app',
//     title: 'Nomad',
//     category: 'UI/UX',
//     description: 'A social travel planning app for digital nomads and adventurers.',
//     heroImage: 'https://placehold.co/800x800/312E81/A5B4FC?text=Nomad',
//   },
//   {
//     id: 'origin-coffee',
//     title: 'Origin',
//     category: 'Packaging',
//     description: 'Sustainable and premium coffee packaging with bold typography.',
//     heroImage: 'https://placehold.co/800x800/7C2D12/FDBA74?text=Origin',
//   },
//   {
//     id: 'voxel-labs',
//     title: 'Voxel',
//     category: 'Motion Graphics',
//     description: 'A 3D motion ident for a next-gen gaming studio.',
//     heroImage: 'https://placehold.co/800x800/365314/BEF264?text=Voxel',
//   },
//   {
//     id: 'cygnus-web',
//     title: 'Cygnus',
//     category: 'Web Design',
//     description: 'An immersive, scroll-based website for a space exploration documentary.',
//     heroImage: 'https://placehold.co/800x800/064E3B/6EE7B7?text=Cygnus',
//   },
//   {
//     id: 'muse-mag',
//     title: 'Muse',
//     category: 'Print Design',
//     description: 'Editorial layout and cover design for an independent arts magazine.',
//     heroImage: 'https://placehold.co/800x800/831843/F9A8D4?text=Muse',
//   },
// ];

// // --- EXPANDED CATEGORIES ---
// const categories = [
//   { name: 'All', icon: LayoutGrid },
//   { name: 'UI/UX', icon: Monitor },
//   { name: 'Brand Identity', icon: Palette },
//   { name: 'Motion Graphics', icon: Zap },
//   { name: 'Packaging', icon: Package },
//   { name: 'Print Design', icon: Printer },
//   { name: 'Web Design', icon: Monitor }, // Web design also uses Monitor icon
// ];

// // --- Kinetic Text Header (Unchanged) ---
// const KineticHeader = () => {
//   const words = ["Creative", "Works", "Archive", "Projects", "Portfolio"];
//   const [currentWord, setCurrentWord] = useState(words[0]);

//   useEffect(() => {
//     const interval = setInterval(() => {
//       setCurrentWord((prev) => {
//         const nextIndex = (words.indexOf(prev) + 1) % words.length;
//         return words[nextIndex];
//       });
//     }, 1500);
//     return () => clearInterval(interval);
//   }, []);

//   const variants = {
//     enter: { opacity: 0, y: 20, filter: 'blur(5px)' },
//     center: { opacity: 1, y: 0, filter: 'blur(0px)' },
//     exit: { opacity: 0, y: -20, filter: 'blur(5px)' },
//   };

//   return (
//     <div className="flex text-5xl md:text-8xl font-bold tracking-tighter text-gray-900 justify-center">
//       <span className="mr-4">My</span>
//       <AnimatePresence mode="wait">
//         <motion.span
//           key={currentWord}
//           variants={variants}
//           initial="enter"
//           animate="center"
//           exit="exit"
//           transition={{ duration: 0.5, type: 'spring', stiffness: 200, damping: 20 }}
//           className="text-blue-600 block"
//         >
//           {currentWord}
//         </motion.span>
//       </AnimatePresence>
//     </div>
//   );
// };

// // --- Project Card Component (Grid View) ---
// const ProjectCard = ({ project }) => {
//   const [isHovered, setIsHovered] = useState(false);
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.4 });

//   const cardVariants = {
//     hidden: { opacity: 0, y: 50, scale: 0.9 },
//     visible: { 
//       opacity: 1, 
//       y: 0, 
//       scale: 1,
//       transition: { type: 'spring', stiffness: 100, damping: 12 }
//     },
//   };

//   return (
//     <Link to={`/projects/${project.id}`}>
//       <motion.div
//         ref={ref}
//         variants={cardVariants}
//         initial="hidden"
//         animate={isInView ? "visible" : "hidden"}
//         className="relative rounded-2xl overflow-hidden shadow-lg cursor-pointer"
//         onHoverStart={() => setIsHovered(true)}
//         onHoverEnd={() => setIsHovered(false)}
//       >
//         <motion.img
//           src={project.heroImage}
//           alt={project.title}
//           className="w-full h-[400px] object-cover"
//           layoutId={`project-hero-${project.id}`}
//           animate={{ scale: isHovered ? 1.05 : 1 }}
//           transition={{ duration: 0.4, ease: 'easeInOut' }}
//         />
//         <AnimatePresence>
//           {isHovered && (
//             <motion.div
//               className="absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent"
//               initial={{ opacity: 0, y: 20 }}
//               animate={{ opacity: 1, y: 0 }}
//               exit={{ opacity: 0, y: 20 }}
//               transition={{ duration: 0.3 }}
//             >
//               <motion.h3 
//                 className="text-2xl font-bold text-white"
//                 layoutId={`project-title-${project.id}`}
//               >
//                 {project.title}
//               </motion.h3>
//               <p className="text-blue-300">{project.category}</p>
//             </motion.div>
//           )}
//         </AnimatePresence>
//       </motion.div>
//     </Link>
//   );
// };

// // --- *** NEW *** Project List Row Component (List View) ---
// const ProjectListRow = ({ project }) => {
//   const ref = useRef(null);
//   const isInView = useInView(ref, { once: true, amount: 0.4 });

//   const rowVariants = {
//     hidden: { opacity: 0, x: -50 },
//     visible: { 
//       opacity: 1, 
//       x: 0,
//       transition: { type: 'spring', stiffness: 100, damping: 15 }
//     },
//   };

//   return (
//     <Link to={`/projects/${project.id}`}>
//       <motion.div
//         ref={ref}
//         variants={rowVariants}
//         initial="hidden"
//         animate={isInView ? "visible" : "hidden"}
//         whileHover={{
//           scale: 1.01,
//           boxShadow: '0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1)' 
//         }}
//         className="flex flex-col md:flex-row items-center bg-white p-4 rounded-2xl shadow-lg cursor-pointer overflow-hidden"
//       >
//         <motion.img
//           src={project.heroImage}
//           alt={project.title}
//           className="w-full md:w-48 h-48 md:h-32 rounded-lg object-cover"
//           layoutId={`project-hero-${project.id}`}
//           transition={{ duration: 0.4, ease: 'easeInOut' }}
//         />
//         <div className="flex-grow p-4">
//           <motion.h3 
//             className="text-2xl font-bold text-gray-900"
//             layoutId={`project-title-${project.id}`}
//           >
//             {project.title}
//           </motion.h3>
//           <p className="text-blue-600 font-medium">{project.category}</p>
//           <p className="text-gray-600 mt-2 hidden md:block">{project.description}</p>
//         </div>
//         <motion.div
//           className="p-4"
//           initial={{ x: -20, opacity: 0 }}
//           animate={{ x: 0, opacity: 1 }}
//           transition={{ delay: 0.2 }}
//         >
//           <ArrowRight className="w-6 h-6 text-gray-400" />
//         </motion.div>
//       </motion.div>
//     </Link>
//   );
// };


// // --- Main Projects Page Component ---
// export default function Projects() {
//   const [filter, setFilter] = useState('All');
//   const [searchQuery, setSearchQuery] = useState('');
//   const [view, setView] = useState('grid'); // 'grid' or 'list'
//   const [visibleCount, setVisibleCount] = useState(6); // For "Load More"

//   // 1. Filter by Category
//   const filteredProjects = allProjects.filter((p) => 
//     filter === 'All' ? true : p.category === filter
//   );

//   // 2. Filter by Search Query
//   const searchedProjects = filteredProjects.filter((p) =>
//     p.title.toLowerCase().includes(searchQuery.toLowerCase())
//   );
  
//   // 3. Paginate
//   const projectsToShow = searchedProjects.slice(0, visibleCount);
  
//   const handleLoadMore = () => {
//     setVisibleCount(prev => prev + 6); // Load 6 more
//   };

//   const containerVariants = {
//     hidden: {},
//     visible: {
//       transition: { staggerChildren: 0.1 }
//     }
//   };

//   return (
//     <div className="bg-gray-50 min-h-screen">
//       <main className="pt-32 pb-24 container mx-auto px-4 sm:px-6 lg:px-8">
//         {/* --- Animated Header --- */}
//         <motion.div 
//           className="text-center mb-12"
//           initial={{ opacity: 0, y: 20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.8, delay: 0.2, ease: 'easeOut' }}
//         >
//           <KineticHeader />
//           <p className="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">
//             A curated selection of my work. Each project is a story of creative
//             problem-solving, passion, and pixel-perfect execution.
//           </p>
//         </motion.div>
        
//         {/* --- *** NEW *** Control Bar (Search, Filter, View) --- */}
//         <motion.div
//           className="sticky top-[72px] z-30 bg-gray-50/80 backdrop-blur-md p-4 mb-8 rounded-2xl shadow"
//           initial={{ opacity: 0, y: -20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.5, delay: 0.4 }}
//         >
//           <div className="flex flex-col md:flex-row gap-4">
//             {/* Search Bar */}
//             <div className="relative flex-grow">
//               <input
//                 type="text"
//                 placeholder="Search projects by title..."
//                 value={searchQuery}
//                 onChange={(e) => setSearchQuery(e.target.value)}
//                 className="w-full pl-10 pr-4 py-3 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
//               />
//               <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400" />
//             </div>
//             {/* View Toggle */}
//             <div className="flex-shrink-0 flex bg-gray-200 rounded-lg p-1">
//               {['grid', 'list'].map((viewMode) => (
//                 <motion.button
//                   key={viewMode}
//                   onClick={() => setView(viewMode)}
//                   className={`relative w-1/2 md:w-auto px-4 py-2 rounded-md text-sm font-medium ${
//                     view === viewMode ? 'text-white' : 'text-gray-600'
//                   }`}
//                   whileHover={{ y: -2 }}
//                 >
//                   {view === viewMode && (
//                     <motion.div
//                       className="absolute inset-0 bg-blue-600 rounded-md"
//                       layoutId="view-active"
//                       transition={{ type: 'spring', stiffness: 300, damping: 30 }}
//                     />
//                   )}
//                   <span className="relative z-10 flex items-center justify-center capitalize">
//                     {viewMode === 'grid' ? <LayoutGrid className="w-4 h-4 mr-2" /> : <List className="w-4 h-4 mr-2" />}
//                     {viewMode}
//                   </span>
//                 </motion.button>
//               ))}
//             </div>
//           </div>
//         </motion.div>

//         {/* --- Animated Filter Bar --- */}
//         <motion.div 
//           className="flex flex-wrap justify-center gap-4 mb-16"
//           initial={{ opacity: 0, y: 20 }}
//           animate={{ opacity: 1, y: 0 }}
//           transition={{ duration: 0.8, delay: 0.6, ease: 'easeOut' }}
//         >
//           {categories.map((cat) => (
//             <motion.button
//               key={cat.name}
//               onClick={() => {
//                 setFilter(cat.name);
//                 setVisibleCount(6); // Reset pagination on filter change
//               }}
//               className={`relative px-5 py-2.5 rounded-lg text-sm font-medium ${
//                 filter === cat.name ? 'text-white' : 'text-gray-700 bg-white shadow-sm hover:bg-gray-100'
//               }`}
//               whileHover={{ y: -2 }}
//             >
//               {filter === cat.name && (
//                 <motion.div
//                   className="absolute inset-0 bg-blue-600 rounded-lg shadow-md"
//                   layoutId="filter-active"
//                   transition={{ type: 'spring', stiffness: 300, damping: 30 }}
//                 />
//               )}
//               <span className="relative z-10 flex items-center">
//                 <cat.icon className="w-4 h-4 mr-2" /> {cat.name}
//               </span>
//             </motion.button>
//           ))}
//         </motion.div>

//         {/* --- Animated Project Grid / List --- */}
//         <AnimatePresence mode="wait">
//           {view === 'grid' ? (
//             <motion.div
//               key="grid"
//               className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"
//               variants={containerVariants}
//               initial="hidden"
//               animate="visible"
//               exit={{ opacity: 0, y: 20 }}
//             >
//               <AnimatePresence>
//                 {projectsToShow.map((project) => (
//                   <ProjectCard key={project.id} project={project} />
//                 ))}
//               </AnimatePresence>
//             </motion.div>
//           ) : (
//             <motion.div
//               key="list"
//               className="space-y-6"
//               variants={containerVariants}
//               initial="hidden"
//               animate="visible"
//               exit={{ opacity: 0, y: 20 }}
//             >
//               <AnimatePresence>
//                 {projectsToShow.map((project) => (
//                   <ProjectListRow key={project.id} project={project} />
//                 ))}
//               </AnimatePresence>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//         {/* --- *** NEW *** "Load More" Button --- */}
//         <AnimatePresence>
//           {visibleCount < searchedProjects.length && (
//             <motion.div
//               className="flex justify-center mt-16"
//               initial={{ opacity: 0, y: 50 }}
//               animate={{ opacity: 1, y: 0 }}
//               exit={{ opacity: 0, y: 50 }}
//             >
//               <motion.button
//                 onClick={handleLoadMore}
//                 className="bg-blue-600 text-white px-8 py-3.5 rounded-lg text-lg font-medium shadow-lg"
//                 whileHover={{ scale: 1.05, y: -2 }}
//                 whileTap={{ scale: 0.95 }}
//               >
//                 Load More Projects
//               </motion.button>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//         {/* No Results Message */}
//         <AnimatePresence>
//           {searchedProjects.length === 0 && (
//             <motion.div
//               className="text-center mt-16"
//               initial={{ opacity: 0, y: 20 }}
//               animate={{ opacity: 1, y: 0 }}
//             >
//               <h3 className="text-2xl font-bold text-gray-900">No Projects Found</h3>
//               <p className="text-gray-600 mt-2">
//                 Try adjusting your search or filter.
//               </p>
//             </motion.div>
//           )}
//         </AnimatePresence>
        
//       </main>
//     </div>
//   );
// }


// // // // import { supabase } from "../lib/supabaseClient";

// // // // /**
// // // //  * Fetches all project categories.
// // // //  */
// // // // export const fetchProjectCategories = async () => {
// // // //   const { data, error } = await supabase
// // // //     .from('project_categories')
// // // //     .select('name, slug')
// // // //     .order('name', { ascending: true });

// // // //   if (error) {
// // // //     console.error('Error fetching categories:', error);
// // // //     return [];
// // // //   }
// // // //   return data;
// // // // };

// // // // /**
// // // //  * Fetches projects with server-side filtering, search, and pagination.
// // // //  */
// // // // export const fetchProjects = async ({
// // // //   page = 1,
// // // //   limit = 9,
// // // //   categorySlug = 'all',
// // // //   searchQuery = '',
// // // // }) => {
// // // //   const from = (page - 1) * limit;
// // // //   const to = from + limit - 1;

// // // //   let query = supabase
// // // //     .from('projects')
// // // //     .select(
// // // //       `
// // // //       id,
// // // //       title,
// // // //       slug,
// // // //       description,
// // // //       hero_media_id,
// // // //       media_assets ( file_path, alt_text ),
// // // //       project_category_links (
// // // //         project_categories ( name, slug )
// // // //       )
// // // //     `,
// // // //       { count: 'exact' } // Request the total count for pagination
// // // //     )
// // // //     .order('created_at', { ascending: false })
// // // //     .range(from, to);

// // // //   // Apply search filter
// // // //   if (searchQuery) {
// // // //     query = query.ilike('title', `%${searchQuery}%`);
// // // //   }

// // // //   // Apply category filter
// // // //   // This requires a join filter
// // // //   if (categorySlug && categorySlug !== 'all') {
// // // //     query = query.eq('project_category_links.project_categories.slug', categorySlug);
// // // //   }

// // // //   const { data, error, count } = await query;

// // // //   if (error) {
// // // //     console.error('Error fetching projects:', error);
// // // //     return { data: [], count: 0 };
// // // //   }
  
// // // //   // Supabase returns a nested structure for joins, let's simplify it
// // // //   const processedData = data.map(project => ({
// // // //     ...project,
// // // //     category: project.project_category_links[0]?.project_categories.name || 'Uncategorized',
// // // //     heroImage: project.media_assets?.file_path || `https://placehold.co/800x800/EEE/333?text=${project.title.replace(' ','+')}`,
// // // //     heroAlt: project.media_assets?.alt_text || project.title,
// // // //   }));

// // // //   return { data: processedData, count: count || 0 };
// // // // };

// // // // /**
// // // //  * Fetches all details for a single project by its slug.
// // // //  */
// // // // export const fetchProjectDetail = async (slug) => {
// // // //   const { data, error } = await supabase
// // // //     .from('projects')
// // // //     .select(
// // // //       `
// // // //       *,
// // // //       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
// // // //       detail_hero_media:media_assets!projects_detail_hero_media_id_fkey ( file_path, alt_text ),
// // // //       tools:project_tool_links ( tools ( name, icon_name ) ),
// // // //       categories:project_category_links ( project_categories ( name, slug ) ),
// // // //       content:project_content_blocks ( "type", "order", content ),
// // // //       gallery:project_gallery (
// // // //         "order",
// // // //         media:media_assets ( file_path, alt_text )
// // // //       )
// // // //     `
// // // //     )
// // // //     .eq('slug', slug)
// // // //     .order('order', { referencedTable: 'project_content_blocks', ascending: true })
// // // //     .order('order', { referencedTable: 'project_gallery', ascending: true })
// // // //     .single();

// // // //   if (error) {
// // // //     console.error('Error fetching project detail:', error);
// // // //     throw error;
// // // //   }
  
// // // //   // Clean up the nested data
// // // //   if (data) {
// // // //     data.tools = data.tools.map(t => t.tools);
// // // //     data.categories = data.categories.map(c => c.project_categories);
// // // //     data.gallery = data.gallery.map(g => ({
// // // //       // Note: the joined table is 'media', not 'media_assets'
// // // //       url: g.media.file_path,
// // // //       alt: g.media.alt_text,
// // // //     }));
// // // //   }

// // // //   return data;
// // // // };

// // // // /**
// // // //  * Fetches the next project in the list (simplified for now).
// // // //  */
// // // // export const fetchNextProject = async (currentSlug) => {
// // // //    const { data, error } = await supabase
// // // //     .from('projects')
// // // //     .select('title, slug, hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text )')
// // // //     .neq('slug', currentSlug) // Not the current one
// // // //     .limit(1); // Just get one

// // // //    if (error) {
// // // //      console.error('Error fetching next project:', error);
// // // //      return null;
// // // //    }
   
// // // //    return data[0];
// // // // };
// // // // import { supabase } from './supabase';
// // // import { supabase } from "../lib/supabaseClient";
// // // /**
// // //  * Fetches all project categories.
// // //  */
// // // export const fetchProjectCategories = async () => {
// // //   const { data, error } = await supabase
// // //     .from('project_categories')
// // //     .select('name, slug')
// // //     .order('name', { ascending: true });

// // //   if (error) {
// // //     console.error('Error fetching categories:', error);
// // //     return [];
// // //   }
// // //   return data;
// // // };

// // // /**
// // //  * Fetches projects with server-side filtering, search, and pagination.
// // //  */
// // // export const fetchProjects = async ({
// // //   page = 1,
// // //   limit = 9,
// // //   categorySlug = 'all',
// // //   searchQuery = '',
// // // }) => {
// // //   const from = (page - 1) * limit;
// // //   const to = from + limit - 1;

// // //   let query = supabase
// // //     .from('projects')
// // //     .select(
// // //       `
// // //       id,
// // //       title,
// // //       slug,
// // //       description,
// // //       hero_media_id,
// // //       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
// // //       project_category_links (
// // //         project_categories ( name, slug )
// // //       )
// // //     `,
// // //       { count: 'exact' } // Request the total count for pagination
// // //     )
// // //     .order('created_at', { ascending: false })
// // //     .range(from, to);

// // //   // Apply search filter
// // //   if (searchQuery) {
// // //     query = query.ilike('title', `%${searchQuery}%`);
// // //   }

// // //   // Apply category filter
// // //   // This requires a join filter
// // //   if (categorySlug && categorySlug !== 'all') {
// // //     query = query.eq('project_category_links.project_categories.slug', categorySlug);
// // //   }

// // //   const { data, error, count } = await query;

// // //   if (error) {
// // //     console.error('Error fetching projects:', error);
// // //     return { data: [], count: 0 };
// // //   }
  
// // //   // Supabase returns a nested structure for joins, let's simplify it
// // //   const processedData = data.map(project => ({
// // //     ...project,
// // //     category: project.project_category_links[0]?.project_categories.name || 'Uncategorized',
// // //     heroImage: project.hero_media?.file_path || `https://placehold.co/800x800/EEE/333?text=${project.title.replace(' ','+')}`,
// // //     heroAlt: project.hero_media?.alt_text || project.title,
// // //   }));

// // //   return { data: processedData, count: count || 0 };
// // // };

// // // /**
// // //  * Fetches all details for a single project by its slug.
// // //  */
// // // export const fetchProjectDetail = async (slug) => {
// // //   const { data, error } = await supabase
// // //     .from('projects')
// // //     .select(
// // //       `
// // //       *,
// // //       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
// // //       detail_hero_media:media_assets!projects_detail_hero_media_id_fkey ( file_path, alt_text ),
// // //       tools:project_tool_links ( tools ( name, icon_name ) ),
// // //       categories:project_category_links ( project_categories ( name, slug ) ),
// // //       content:project_content_blocks ( "type", "order", content ),
// // //       gallery:project_gallery (
// // //         "order",
// // //         media:media_assets ( file_path, alt_text )
// // //       )
// // //     `
// // //     )
// // //     .eq('slug', slug)
// // //     .order('order', { referencedTable: 'project_content_blocks', ascending: true })
// // //     .order('order', { referencedTable: 'project_gallery', ascending: true })
// // //     .single();

// // //   if (error) {
// // //     console.error('Error fetching project detail:', error);
// // //     throw error;
// // //   }
  
// // //   // Clean up the nested data
// // //   if (data) {
// // //     data.tools = data.tools.map(t => t.tools);
// // //     data.categories = data.categories.map(c => c.project_categories);
// // //     data.gallery = data.gallery.map(g => ({
// // //       // Note: the joined table is 'media', not 'media_assets'
// // //       url: g.media.file_path,
// // //       alt: g.media.alt_text,
// // //     }));
// // //   }

// // //   return data;
// // // };

// // // /**
// // //  * Fetches the next project in the list (simplified for now).
// // //  */
// // // export const fetchNextProject = async (currentSlug) => {
// // //    const { data, error } = await supabase
// // //     .from('projects')
// // //     .select('title, slug, hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text )')
// // //     .neq('slug', currentSlug) // Not the current one
// // //     .limit(1); // Just get one

// // //    if (error) {
// // //      console.error('Error fetching next project:', error);
// // //      return null;
// // //    }
   
// // //    return data[0];
// // // };

// // // import { supabase } from './supabase';
// // import { supabase } from "../lib/supabaseClient";
// // /**
// //  * Fetches all project categories.
// //  */
// // export const fetchProjectCategories = async () => {
// //   const { data, error } = await supabase
// //     .from('project_categories')
// //     .select('name, slug')
// //     .order('name', { ascending: true });

// //   if (error) {
// //     console.error('Error fetching categories:', error);
// //     return [];
// //   }
// //   return data;
// // };

// // /**
// //  * Fetches projects with server-side filtering, search, and pagination.
// //  */
// // export const fetchProjects = async ({
// //   page = 1,
// //   limit = 9,
// //   categorySlug = 'all',
// //   searchQuery = '',
// // }) => {
// //   const from = (page - 1) * limit;
// //   const to = from + limit - 1;

// //   let query = supabase
// //     .from('projects')
// //     .select(
// //       `
// //       id,
// //       title,
// //       slug,
// //       description,
// //       hero_media_id,
// //       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
// //       project_category_links (
// //         project_categories ( name, slug )
// //       )
// //     `,
// //       { count: 'exact' } // Request the total count for pagination
// //     )
// //     .order('created_at', { ascending: false })
// //     .range(from, to);

// //   // Apply search filter
// //   if (searchQuery) {
// //     query = query.ilike('title', `%${searchQuery}%`);
// //   }

// //   // Apply category filter
// //   // This requires a join filter
// //   if (categorySlug && categorySlug !== 'all') {
// //     query = query.eq('project_category_links.project_categories.slug', categorySlug);
// //   }

// //   const { data, error, count } = await query;

// //   if (error) {
// //     console.error('Error fetching projects:', error);
// //     return { data: [], count: 0 };
// //   }
  
// //   // Supabase returns a nested structure for joins, let's simplify it
// //   const processedData = data.map(project => ({
// //     ...project,
// //     // --- FIX 1 ---
// //     // Added more optional chaining to prevent crash on empty categories
// //     category: project.project_category_links?.[0]?.project_categories?.name || 'Uncategorized',
// //     heroImage: project.hero_media?.file_path || `https://placehold.co/800x800/EEE/333?text=${project.title.replace(' ','+')}`,
// //     heroAlt: project.hero_media?.alt_text || project.title,
// //   }));

// //   return { data: processedData, count: count || 0 };
// // };

// // /**
// //  * Fetches all details for a single project by its slug.
// //  */
// // export const fetchProjectDetail = async (slug) => {
// //   const { data, error } = await supabase
// //     .from('projects')
// //     .select(
// //       `
// //       *,
// //       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
// //       detail_hero_media:media_assets!projects_detail_hero_media_id_fkey ( file_path, alt_text ),
// //       tools:project_tool_links ( tools ( name, icon_name ) ),
// //       categories:project_category_links ( project_categories ( name, slug ) ),
// //       content:project_content_blocks ( "type", "order", content ),
// //       gallery:project_gallery (
// //         "order",
// //         media:media_assets ( file_path, alt_text )
// //       )
// //     `
// //     )
// //     .eq('slug', slug)
// //     .order('order', { referencedTable: 'project_content_blocks', ascending: true })
// //     .order('order', { referencedTable: 'project_gallery', ascending: true })
// //     .single();

// //   // --- FIX 2 ---
// //   // Check for the "0 rows" error and return null instead of crashing
// //   if (error) {
// //     if (error.code === 'PGRST116') {
// //       // PGRST116: "The result contains 0 rows"
// //       console.warn(`Project not found for slug: ${slug}`);
// //       return null; // Return null to show "Not Found" page
// //     }
// //     // For other errors, still throw
// //     console.error('Error fetching project detail:', error);
// //     throw error;
// //   }
  
// //   // Clean up the nested data
// //   if (data) {
// //     data.tools = data.tools.map(t => t.tools);
// //     data.categories = data.categories.map(c => c.project_categories);
// //     data.gallery = data.gallery.map(g => ({
// //       // Note: the joined table is 'media', not 'media_assets'
// //       url: g.media.file_path,
// //       alt: g.media.alt_text,
// //     }));
// //   }

// //   return data;
// // };

// // /**
// //  * Fetches the next project in the list (simplified for now).
// //  */
// // export const fetchNextProject = async (currentSlug) => {
// //    const { data, error } = await supabase
// //     .from('projects')
// //     .select('title, slug, hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text )')
// //     .neq('slug', currentSlug) // Not the current one
// //     .limit(1); // Just get one

// //    if (error) {
// //      console.error('Error fetching next project:', error);
// //      return null;
// //    }
   
// //    return data[0];
// // };


// import { supabase } from "../lib/supabaseClient";
// /**
//  * Fetches all project categories.
//  */
// export const fetchProjectCategories = async () => {
//   const { data, error } = await supabase
//     .from('project_categories')
//     .select('name, slug')
//     .order('name', { ascending: true });

//   if (error) {
//     console.error('Error fetching categories:', error);
//     return [];
//   }
//   return data;
// };

// /**
//  * Fetches projects with server-side filtering, search, and pagination.
//  */
// export const fetchProjects = async ({
//   page = 1,
//   limit = 9,
//   categorySlug = 'all',
//   searchQuery = '',
// }) => {
//   const from = (page - 1) * limit;
//   const to = from + limit - 1;

//   let query = supabase
//     .from('projects')
//     .select(
//       `
//       id,
//       title,
//       slug,
//       description,
//       hero_media_id,
//       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
      
//       !inner (
//         project_category_links!inner (
//           project_categories!inner ( name, slug )
//         )
//       )
//     `,
//       { count: 'exact' } // Request the total count for pagination
//     )
//     .order('created_at', { ascending: false })
//     .range(from, to);

//   // Apply search filter
//   if (searchQuery) {
//     query = query.ilike('title', `%${searchQuery}%`);
//   }

//   // Apply category filter
//   // This requires a join filter
//   if (categorySlug && categorySlug !== 'all') {
//     // This will now work because of the "!inner" join in the select
//     query = query.eq('project_category_links.project_categories.slug', categorySlug);
//   }

//   const { data, error, count } = await query;

//   if (error) {
//     console.error('Error fetching projects:', error);
//     return { data: [], count: 0 };
//   }
  
//   // Supabase returns a nested structure for joins, let's simplify it
//   const processedData = data.map(project => ({
//     ...project,
//     // --- FIX 1 ---
//     // Added more optional chaining to prevent crash on empty categories
//     category: project.project_category_links?.[0]?.project_categories?.name || 'Uncategorized',
//     heroImage: project.hero_media?.file_path || `https://placehold.co/800x800/EEE/333?text=${project.title.replace(' ','+')}`,
//     heroAlt: project.hero_media?.alt_text || project.title,
//   }));

//   return { data: processedData, count: count || 0 };
// };

// /**
//  * Fetches all details for a single project by its slug.
//  */
// export const fetchProjectDetail = async (slug) => {
// // ... (this function is correct from your file) ...
//   const { data, error } = await supabase
//     .from('projects')
//     .select(
//       `
//       *,
//       hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text ),
//       detail_hero_media:media_assets!projects_detail_hero_media_id_fkey ( file_path, alt_text ),
//       tools:project_tool_links ( tools ( name, icon_name ) ),
//       categories:project_category_links ( project_categories ( name, slug ) ),
//       content:project_content_blocks ( "type", "order", content ),
//       gallery:project_gallery (
//         "order",
//         media:media_assets ( file_path, alt_text )
//       )
//     `
//     )
//     .eq('slug', slug)
//     .order('order', { referencedTable: 'project_content_blocks', ascending: true })
//     .order('order', { referencedTable: 'project_gallery', ascending: true })
//     .single();

//   // --- FIX 2 ---
//   // Check for the "0 rows" error and return null instead of crashing
//   if (error) {
//     if (error.code === 'PGRST116') {
//       // PGRST116: "The result contains 0 rows"
//       console.warn(`Project not found for slug: ${slug}`);
//       return null; // Return null to show "Not Found" page
//     }
//     // For other errors, still throw
//     console.error('Error fetching project detail:', error);
//     throw error;
//   }
  
//   // Clean up the nested data
// // ... (this logic is correct from your file) ...
//   if (data) {
//     data.tools = data.tools.map(t => t.tools);
//     data.categories = data.categories.map(c => c.project_categories);
//     data.gallery = data.gallery.map(g => ({
//       // Note: the joined table is 'media', not 'media_assets'
//       url: g.media.file_path,
//       alt: g.media.alt_text,
//     }));
//   }

//   return data;
// };

// /**
//  * Fetches the next project in the list (simplified for now).
//  */
// // ... (this function is correct from your file) ...
// export const fetchNextProject = async (currentSlug) => {
//    const { data, error } = await supabase
//     .from('projects')
//     .select('title, slug, hero_media:media_assets!projects_hero_media_id_fkey ( file_path, alt_text )')
//     .neq('slug', currentSlug) // Not the current one
//     .limit(1); // Just get one

//    if (error) {
//      console.error('Error fetching next project:', error);
//      return null;
//    }
   
//    return data[0];
// };




// // import React, { useState, useEffect, useRef } from 'react';
// // import { motion, AnimatePresence } from 'framer-motion';
// // import { 
// //   ArrowRight, 
// //   Send, 
// //   Check, 
// //   Loader, 
// //   Mail,
// //   Twitter,
// //   Linkedin,
// //   Instagram
// // } from 'lucide-react';

// // // --- Kinetic Text Header ---
// // const KineticHeader = () => {
// //   const words = ["Together", "Awesome", "Big", "New"];
// //   const [currentWord, setCurrentWord] = useState(words[0]);

// //   useEffect(() => {
// //     const interval = setInterval(() => {
// //       setCurrentWord((prev) => {
// //         const nextIndex = (words.indexOf(prev) + 1) % words.length;
// //         return words[nextIndex];
// //       });
// //     }, 1500);
// //     return () => clearInterval(interval);
// //   }, []);

// //   const variants = {
// //     enter: { opacity: 0, y: 20 },
// //     center: { opacity: 1, y: 0 },
// //     exit: { opacity: 0, y: -20 },
// //   };

// //   return (
// //     <div className="flex text-5xl md:text-7xl font-bold tracking-tighter text-gray-900">
// //       <span className="mr-4">Let's build something</span>
// //       <AnimatePresence mode="wait">
// //         <motion.span
// //           key={currentWord}
// //           variants={variants}
// //           initial="enter"
// //           animate="center"
// //           exit="exit"
// //           transition={{ duration: 0.5, type: 'spring', stiffness: 200, damping: 20 }}
// //           className="text-blue-600 block"
// //         >
// //           {currentWord}
// //         </motion.span>
// //       </AnimatePresence>
// //     </div>
// //   );
// // };

// // // --- Animated Form Field ---
// // const FormField = ({ label, name, type, register, error, delay }) => (
// //   <motion.div
// //     className="relative"
// //     initial={{ opacity: 0, y: 20 }}
// //     animate={{ opacity: 1, y: 0 }}
// //     transition={{ duration: 0.5, delay: delay }}
// //   >
// //     <label htmlFor={name} className="block text-sm font-medium text-gray-700">
// //       {label}
// //     </label>
// //     {type === 'textarea' ? (
// //       <textarea
// //         id={name}
// //         name={name}
// //         rows="4"
// //         className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
// //         {...register(name)}
// //       />
// //     ) : (
// //       <input
// //         id={name}
// //         name={name}
// //         type={type}
// //         className="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"
// //         {...register(name)}
// //       />
// //     )}
// //     {error && <p className="mt-1 text-sm text-red-600">{error.message}</p>}
// //   </motion.div>
// // );

// // // --- Futuristic 3D Floating Shape ---
// // const FloatingShape = () => {
// //   return (
// //     <motion.div
// //       className="w-64 h-64 md:w-96 md:h-96"
// //       animate={{
// //         rotate: [0, 360],
// //         scale: [1, 1.1, 1],
// //       }}
// //       transition={{
// //         duration: 30,
// //         repeat: Infinity,
// //         ease: 'linear'
// //       }}
// //     >
// //       <motion.div
// //         className="absolute w-full h-full bg-blue-500 rounded-full opacity-30"
// //         animate={{
// //           x: [0, 50, 0, -50, 0],
// //           y: [0, -50, 0, 50, 0],
// //         }}
// //         transition={{
// //           duration: 15,
// //           repeat: Infinity,
// //           ease: 'easeInOut'
// //         }}
// //       />
// //       <motion.div
// //         className="absolute w-3/4 h-3/4 bg-purple-500 rounded-full opacity-30"
// //         style={{ top: '12.5%', left: '12.5%' }}
// //         animate={{
// //           x: [0, -30, 0, 30, 0],
// //           y: [0, 30, 0, -30, 0],
// //         }}
// //         transition={{
// //           duration: 10,
// //           repeat: Infinity,
// //           ease: 'easeInOut'
// //         }}
// //       />
// //     </motion.div>
// //   );
// // };

// // // --- Animated Social Links ---
// // const SocialLinks = () => {
// //   const socials = [
// //     { icon: Mail, label: 'bharath.gaddam@email.com', href: 'mailto:bharath.gaddam@email.com' },
// //     { icon: Linkedin, label: 'LinkedIn Profile', href: '#' },
// //     { icon: Instagram, label: 'Instagram', href: '#' },
// //     { icon: Twitter, label: 'Twitter', href: '#' },
// //   ];

// //   return (
// //     <motion.div 
// //       className="space-y-4"
// //       initial="hidden"
// //       animate="visible"
// //       transition={{ staggerChildren: 0.1, delayChildren: 0.6 }}
// //     >
// //       {socials.map((social, i) => (
// //         <motion.a
// //           key={i}
// //           href={social.href}
// //           className="flex items-center text-gray-600 hover:text-blue-600 group"
// //           variants={{
// //             hidden: { opacity: 0, x: -20 },
// //             visible: { opacity: 1, x: 0 }
// //           }}
// //           whileHover={{ x: 5 }}
// //         >
// //           <social.icon className="w-6 h-6 mr-3" />
// //           <span className="font-medium">{social.label}</span>
// //         </motion.a>
// //       ))}
// //     </motion.div>
// //   );
// // };


// // // --- Main Contact Page Component ---
// // export default function Contact() {
// //   // Form state: 'idle', 'submitting', 'success'
// //   const [formState, setFormState] = useState('idle');

// //   // In a real app, you'd use react-hook-form or similar
// //   // This is a simulation
// //   const register = (name) => ({ name }); // Mock register
  
// //   const handleSubmit = (e) => {
// //     e.preventDefault();
// //     setFormState('submitting');
    
// //     // Simulate API call
// //     setTimeout(() => {
// //       setFormState('success');
// //     }, 2000);
// //   };

// //   return (
// //     <div className="pt-32 pb-24 container mx-auto px-4 sm:px-6 lg:px-8 overflow-hidden">
      
// //       {/* --- Animated Header --- */}
// //       <motion.div 
// //         className="text-center mb-16"
// //         initial={{ opacity: 0, y: 20 }}
// //         animate={{ opacity: 1, y: 0 }}
// //         transition={{ duration: 0.8, delay: 0.2, ease: 'easeOut' }}
// //       >
// //         <KineticHeader />
// //         <p className="mt-4 text-lg text-gray-600 max-w-2xl mx-auto">
// //           Have a project in mind? Let's talk. I'm always open to discussing new
// //           ideas and challenging opportunities.
// //         </p>
// //       </motion.div>

// //       <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
// //         {/* --- Left Side: Form --- */}
// //         <div className="relative">
// //           <AnimatePresence>
// //             {formState === 'success' ? (
// //               <motion.div
// //                 key="success"
// //                 className="flex flex-col items-center justify-center text-center bg-gray-50 p-12 rounded-2xl h-full"
// //                 initial={{ opacity: 0, scale: 0.8 }}
// //                 animate={{ opacity: 1, scale: 1 }}
// //                 exit={{ opacity: 0, scale: 0.8 }}
// //               >
// //                 <motion.div
// //                   initial={{ scale: 0 }}
// //                   animate={{ scale: 1 }}
// //                   transition={{ delay: 0.2, type: 'spring' }}
// //                 >
// //                   <Check className="w-16 h-16 text-white bg-green-500 p-3 rounded-full" />
// //                 </motion.div>
// //                 <h2 className="text-2xl font-bold text-gray-900 mt-6">Thank You!</h2>
// //                 <p className="text-gray-600 mt-2">
// //                   Your message has been sent. I'll get back to you as soon as possible.
// //                 </p>
// //               </motion.div>
// //             ) : (
// //               <motion.form
// //                 key="form"
// //                 onSubmit={handleSubmit}
// //                 className="space-y-6 bg-white p-8 rounded-2xl shadow-xl"
// //                 initial={{ opacity: 0 }}
// //                 animate={{ opacity: 1 }}
// //               >
// //                 <FormField label="Full Name" name="name" type="text" register={register} delay={0.4} />
// //                 <FormField label="Email Address" name="email" type="email" register={register} delay={0.5} />
// //                 <FormField label="Message" name="message" type="textarea" register={register} delay={0.6} />
                
// //                 {/* Animated Submit Button */}
// //                 <motion.div 
// //                   className="pt-4"
// //                   initial={{ opacity: 0, y: 20 }}
// //                   animate={{ opacity: 1, y: 0 }}
// //                   transition={{ duration: 0.5, delay: 0.7 }}
// //                 >
// //                   <motion.button
// //                     type="submit"
// //                     className="w-full bg-gray-900 text-white px-6 py-3.5 rounded-lg text-lg font-medium shadow-lg flex items-center justify-center"
// //                     whileHover={{ scale: 1.03 }}
// //                     whileTap={{ scale: 0.98 }}
// //                     disabled={formState === 'submitting'}
// //                   >
// //                     <AnimatePresence mode="wait">
// //                       {formState === 'idle' && (
// //                         <motion.span 
// //                           key="idle"
// //                           className="flex items-center"
// //                           exit={{ opacity: 0, y: 10 }}
// //                         >
// //                           Send Message <Send className="w-5 h-5 ml-2" />
// //                         </motion.span>
// //                       )}
// //                       {formState === 'submitting' && (
// //                         <motion.span 
// //                           key="submitting"
// //                           className="flex items-center"
// //                           initial={{ opacity: 0, y: -10 }}
// //                           animate={{ opacity: 1, y: 0 }}
// //                           exit={{ opacity: 0, y: 10 }}
// //                         >
// //                           Submitting... 
// //                           <motion.div
// //                             className="ml-2"
// //                             animate={{ rotate: 360 }}
// //                             transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}
// //                           >
// //                             <Loader className="w-5 h-5" />
// //                           </motion.div>
// //                         </motion.span>
// //                       )}
// //                     </AnimatePresence>
// //                   </motion.button>
// //                 </motion.div>
// //               </motion.form>
// //             )}
// //           </AnimatePresence>
// //         </div>
        
// //         {/* --- Right Side: Info & Visual --- */}
// //         <div className="space-y-12">
// //           <motion.div
// //             initial={{ opacity: 0, x: 50 }}
// //             animate={{ opacity: 1, x: 0 }}
// //             transition={{ duration: 0.7, delay: 0.5 }}
// //           >
// //             <h3 className="text-2xl font-semibold text-gray-900 mb-6">
// //               Or reach out directly
// //             </h3>
// //             <SocialLinks />
// //           </motion.div>
          
// //           <div className="flex items-center justify-center h-64 md:h-auto">
// //             <FloatingShape />
// //           </div>
// //         </div>
        
// //       </div>
// //     </div>
// //   );
// // }




// import React, { useState, useEffect } from 'react';
// import { motion, AnimatePresence } from 'framer-motion';
// import {
//   Send,
//   Check,
//   Loader,
//   Mail,
//   Loader2,
//   AlertCircle,
// } from 'lucide-react';
// import { useForm } from 'react-hook-form'; // Using react-hook-form
// import {
//   fetchContactPageContent,
//   submitContactForm,
// } from '../api/contactpage';
// import { Icon } from '../components/common/IconMap'; // Use our IconMap
// import AnimateOnScroll from '../components/common/AnimateOnScroll';

// // --- Kinetic Text Header (Now Dynamic) ---
// const KineticHeader = ({ staticText, words }) => {
//   const [currentWord, setCurrentWord] = useState(words[0]);

//   useEffect(() => {
//     if (words.length <= 1) return; // Don't cycle if only one word
//     const interval = setInterval(() => {
//       setCurrentWord((prev) => {
//         const nextIndex = (words.indexOf(prev) + 1) % words.length;
//         return words[nextIndex];
//       });
//     }, 1500);
//     return () => clearInterval(interval);
//   }, [words]);

//   const variants = {
//     enter: { opacity: 0, y: 20 },
//     center: { opacity: 1, y: 0 },
//     exit: { opacity: 0, y: -20 },
//   };

//   return (
//     <div className="flex flex-wrap text-5xl md:text-7xl font-bold tracking-tighter text-gray-900">
//       <span className="mr-4">{staticText}</span>
//       <AnimatePresence mode="wait">
//         <motion.span
//           key={currentWord}
//           variants={variants}
//           initial="enter"
//           animate="center"
//           exit="exit"
//           transition={{ duration: 0.5, type: 'spring', stiffness: 100 }}
//           className="text-blue-600"
//         >
//           {currentWord}
//         </motion.span>
//       </AnimatePresence>
//     </div>
//   );
// };

// // --- Social Links (Now Dynamic) ---
// const SocialLinks = ({ socials, title }) => (
//   <AnimateOnScroll className="space-y-4">
//     <h3 className="text-2xl font-semibold text-gray-900 mb-6">{title}</h3>
//     {socials.map((link, i) => (
//       <motion.a
//         key={link.id}
//         href={link.url}
//         target="_blank"
//         rel="noopener noreferrer"
//         className="flex items-center text-lg text-gray-600 hover:text-blue-600 group"
//         initial={{ opacity: 0, x: 20 }}
//         animate={{ opacity: 1, x: 0 }}
//         transition={{ delay: i * 0.1 }}
//       >
//         <Icon
//           name={link.icon_name}
//           className="w-6 h-6 mr-3 text-gray-400 group-hover:text-blue-600"
//         />
//         {link.platform}
//       </motion.a>
//     ))}
//   </AnimateOnScroll>
// );

// // --- Floating Shape (Unchanged) ---
// const FloatingShape = () => (
//   <motion.div
//     className="w-64 h-64"
//     animate={{
//       scale: [1, 1.1, 1],
//       rotate: [0, 15, -10, 0],
//       y: [0, -20, 0],
//     }}
//     transition={{ duration: 15, repeat: Infinity, ease: 'easeInOut' }}
//   >
//     <div className="w-full h-full bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full opacity-30 blur-2xl" />
//     <div className="absolute top-1/2 left-1/2 w-48 h-48 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full opacity-30 blur-2xl -mt-10" />
//   </motion.div>
// );

// // --- Form Input Components (for react-hook-form) ---
// const FormInput = ({ label, name, register, errors, ...rest }) => (
//   <div className="flex flex-col">
//     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">
//       {label}
//     </label>
//     <input
//       id={name}
//       className={`p-3 border rounded-lg ${
//         errors[name] ? 'border-red-500' : 'border-gray-300'
//       }`}
//       {...register(name)}
//       {...rest}
//     />
//     {errors[name] && (
//       <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>
//     )}
//   </div>
// );

// const FormSelect = ({ label, name, register, errors, children, ...rest }) => (
//   <div className="flex flex-col">
//     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">
//       {label}
//     </label>
//     <select
//       id={name}
//       className={`p-3 border rounded-lg bg-white ${
//         errors[name] ? 'border-red-500' : 'border-gray-300'
//       }`}
//       {...register(name)}
//       {...rest}
//     >
//       {children}
//     </select>
//     {errors[name] && (
//       <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>
//     )}
//   </div>
// );

// const FormTextarea = ({ label, name, register, errors, ...rest }) => (
//   <div className="flex flex-col sm:col-span-2">
//     <label htmlFor={name} className="mb-2 text-sm font-medium text-gray-700">
//       {label}
//     </label>
//     <textarea
//       id={name}
//       rows="5"
//       className={`p-3 border rounded-lg ${
//         errors[name] ? 'border-red-500' : 'border-gray-300'
//       }`}
//       {...register(name)}
//       {...rest}
//     />
//     {errors[name] && (
//       <span className="text-red-500 text-sm mt-1">{errors[name].message}</span>
//     )}
//   </div>
// );

// // --- Main Contact Page Component ---
// export default function Contact() {
//   const [content, setContent] = useState(null);
//   const [loading, setLoading] = useState(true);
//   const [formState, setFormState] = useState('idle'); // idle | loading | success | error

//   const {
//     register,
//     handleSubmit,
//     reset,
//     formState: { errors },
//   } = useForm({
//     defaultValues: {
//       name: '',
//       email: '',
//       service_id: '',
//       budget_id: '',
//       timeline: '',
//       message: '',
//     },
//   });

//   // Fetch all page content on load
//   useEffect(() => {
//     const loadContent = async () => {
//       setLoading(true);
//       const data = await fetchContactPageContent();
//       setContent(data);
//       setLoading(false);
//     };
//     loadContent();
//   }, []);

//   const onSubmit = async (formData) => {
//     setFormState('loading');
//     try {
//       const { success } = await submitContactForm(formData);
//       if (success) {
//         setFormState('success');
//         reset(); // Clear the form
//         setTimeout(() => setFormState('idle'), 3000); // Reset after 3s
//       } else {
//         throw new Error('Form submission failed');
//       }
//     } catch (error) {
//       setFormState('error');
//       setTimeout(() => setFormState('idle'), 3000); // Reset after 3s
//     }
//   };

//   if (loading) {
//     return (
//       <div className="h-screen flex items-center justify-center">
//         <Loader2 className="w-16 h-16 animate-spin text-blue-600" />
//       </div>
//     );
//   }

//   const { config, services, budgets, socials } = content;

//   return (
//     <div className="container mx-auto px-4 sm:px-6 lg:px-8 py-24 sm:py-32">
//       <div className="grid grid-cols-1 lg:grid-cols-2 gap-16">
//         {/* --- Left Side: Header & Form --- */}
//         <div>
//           <KineticHeader
//             staticText={config?.title_static || "Let's build something"}
//             words={config?.title_animated || ['Awesome']}
//           />
//           <p className="mt-6 text-lg text-gray-600">
//             Have a project in mind? Or just want to say hi?
//             Fill out the form, and I'll get back to you.
//           </p>

//           <AnimatePresence mode="wait">
//             {formState === 'success' ? (
//               <motion.div
//                 key="success"
//                 initial={{ opacity: 0, y: 30 }}
//                 animate={{ opacity: 1, y: 0 }}
//                 exit={{ opacity: 0, y: -30 }}
//                 className="my-10 p-8 bg-green-100 text-green-800 rounded-lg text-center"
//               >
//                 <Check className="w-16 h-16 mx-auto mb-4" />
//                 <h2 className="text-2xl font-bold">Message Sent!</h2>
//                 <p>Thanks for reaching out. I'll get back to you soon.</p>
//               </motion.div>
//             ) : (
//               <motion.form
//                 key="form"
//                 onSubmit={handleSubmit(onSubmit)}
//                 className="mt-10 grid grid-cols-1 sm:grid-cols-2 gap-6"
//                 initial={{ opacity: 1 }}
//                 exit={{ opacity: 0 }}
//               >
//                 <FormInput
//                   label="Your Name"
//                   name="name"
//                   register={register}
//                   errors={errors}
//                   rules={{ required: 'Name is required' }}
//                   placeholder="Jane Doe"
//                 />
//                 <FormInput
//                   label="Your Email"
//                   name="email"
//                   type="email"
//                   register={register}
//                   errors={errors}
//                   rules={{
//                     required: 'Email is required',
//                     pattern: {
//                       value: /^\S+@\S+$/i,
//                       message: 'Invalid email address',
//                     },
//                   }}
//                   placeholder="jane.doe@example.com"
//                 />
//                 <FormSelect
//                   label="Service of Interest"
//                   name="service_id"
//                   register={register}
//                   errors={errors}
//                 >
//                   <option value="">Select a service...</option>
//                   {services.map((service) => (
//                     <option key={service.id} value={service.id}>
//                       {service.title}
//                     </option>
//                   ))}
//                 </FormSelect>
//                 <FormSelect
//                   label="Your Budget"
//                   name="budget_id"
//                   register={register}
//                   errors={errors}
//                 >
//                   <option value="">Select your budget...</option>
//                   {budgets.map((budget) => (
//                     <option key={budget.id} value={budget.id}>
//                       {budget.label}
//                     </option>
//                   ))}
//                 </FormSelect>
//                 <FormInput
//                   label="Timeline"
//                   name="timeline"
//                   register={register}
//                   errors={errors}
//                   placeholder="e.g., 'In 3-6 months'"
//                   className="sm:col-span-2"
//                 />
//                 <FormTextarea
//                   label="Message"
//                   name="message"
//                   register={register}
//                   errors={errors}
//                   rules={{ required: 'Message is required' }}
//                   placeholder="Tell me about your project..."
//                 />
//                 <motion.div
//                   className="sm:col-span-2 flex justify-start"
//                   layout
//                 >
//                   <motion.button
//                     type="submit"
//                     disabled={formState === 'loading'}
//                     className="inline-flex items-center bg-blue-600 text-white px-8 py-3.5 rounded-lg text-lg font-medium shadow-lg hover:bg-blue-700 transition-all duration-300 w-auto"
//                     whileHover={{ scale: 1.05 }}
//                     whileTap={{ scale: 0.95 }}
//                   >
//                     <AnimatePresence mode="wait">
//                       {formState === 'idle' && (
//                         <motion.span
//                           key="idle"
//                           className="flex items-center"
//                           initial={{ opacity: 0, y: 10 }}
//                           animate={{ opacity: 1, y: 0 }}
//                           exit={{ opacity: 0, y: -10 }}
//                         >
//                           Send Message <Send className="w-5 h-5 ml-2" />
//                         </motion.span>
//                       )}
//                       {formState === 'loading' && (
//                         <motion.span
//                           key="loading"
//                           className="flex items-center"
//                           initial={{ opacity: 0, y: 10 }}
//                           animate={{ opacity: 1, y: 0 }}
//                           exit={{ opacity: 0, y: -10 }}
//                         >
//                           Submitting...
//                           <Loader className="w-5 h-5 ml-2 animate-spin" />
//                         </motion.span>
//                       )}
//                       {formState === 'error' && (
//                         <motion.span
//                           key="error"
//                           className="flex items-center bg-red-500 text-white px-8 py-3.5 -m-3.5 rounded-lg"
//                           initial={{ opacity: 0, y: 10 }}
//                           animate={{ opacity: 1, y: 0 }}
//                           exit={{ opacity: 0, y: -10 }}
//                         >
//                           Error! Try again.
//                           <AlertCircle className="w-5 h-5 ml-2" />
//                         </motion.span>
//                       )}
//                     </AnimatePresence>
//                   </motion.button>
//                 </motion.div>
//               </motion.form>
//             )}
//           </AnimatePresence>
//         </div>

//         {/* --- Right Side: Info & Visual --- */}
//         <div className="space-y-12">
//           <SocialLinks
//             socials={socials}
//             title={config?.reach_out_title || 'Or reach out directly'}
//           />
//           <div className="flex items-center justify-center h-64 md:h-96">
//             <FloatingShape />
//           </div>
//         </div>
//       </div>
//     </div>
//   );
// }


